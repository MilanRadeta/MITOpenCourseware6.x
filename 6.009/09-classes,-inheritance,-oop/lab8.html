<!DOCTYPE html>

<html>
<head>
<!-- This page was generated by CAT-SOOP 2021.2.0.dev1971+hg.  miau. -->
<meta charset="utf-8"/>
<title>Lab 8: Symbolic Algebra | 6.009 Fall 2020</title>
<link href="https://py.mit.edu/_static/fall20/logo.gif" rel="icon" type="image/gif"/>
<!-- include catsoop base css -->
<link href="https://py.mit.edu/_static/_base/themes/base.css" rel="stylesheet" type="text/css"/>
<!-- set up JS namespace for catsoop -->
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    var catsoop = {plugins: {}};

    function toggleResponsiveHeader(){
        document.getElementsByTagName('header')[0].classList.toggle('responsive');
    }

    window.addEventListener('DOMContentLoaded', function(){
        var menu_boxes = document.getElementsByClassName('dropdown-checkbox');
        for(var i=0; i<menu_boxes.length; i++){
            menu_boxes[i].checked = false;
        }
    });

    function clearMenu(menu){
       menu.children[1].checked = false;
    }
    // @license-end
    </script>
<!-- load in katex and CAT-SOOP-specific math rendering  -->
<script src="https://py.mit.edu/_static/_base/scripts/katex/katex.min.js" type="text/javascript"></script>
<link href="https://py.mit.edu/_static/_base/scripts/katex/katex.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    catsoop.katex_macros = {};
    catsoop.render_math = function (elt) {
        var tex = elt.innerText; // TeX Source
        var display = elt.classList.contains('cs_displaymath');
        try {
            katex.render(tex, elt, {displayMode: display, macros: catsoop.katex_macros});
        }catch(e) {
            console.log(e);
            elt.innerHTML = "<font color='red'><b>Could not parse math:</b> <tt>" + tex + "</tt></font>";
        }
        elt.classList.remove('cs_math_to_render');
    }


    catsoop.render_all_math = function (elt){
        var mathelts = elt.getElementsByClassName('cs_math_to_render');
        while(mathelts.length > 0){
            catsoop.render_math(mathelts[0]);
        }
    }
    document.addEventListener("DOMContentLoaded", function(event) {
          catsoop.render_all_math(document);
    });
    // @license-end
    </script>
<!-- load in diagram stuff -->
<script src="https://py.mit.edu/_static/_base/scripts/cs_diagrams.js" type="text/javascript"></script>
<script type="text/javascript">
        catsoop.diagram_sources = {};
    </script>
<!-- Syntax Highlighting -->
<script src="https://py.mit.edu/_static/_base/scripts/highlight/highlight.min.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/highlightjs-line-numbers.js" type="text/javascript"></script>
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    hljs.initHighlightingOnLoad();
    window.addEventListener('DOMContentLoaded', function(){
        document.querySelectorAll('.hl code').forEach((block) => {
            hljs.highlightBlock(block);
        });
        document.querySelectorAll('code.highlight-lines').forEach(function(b){
            hljs.lineNumbersBlock(b);
            if ((b.innerHTML.trim().match(/\r\n|\r|\n/g) || []).length > 0){
                b.parentElement.style = "padding-left: 0px !important;"
                b.classList.add('hljs');
            }
        });
    });
    // @license-end
    </script>
<style>
      :root {
        --cs-base-bg-color: #039bba;
        --cs-light-bg-color: #62d5ed;
        --cs-base-font-color: #fff;
        --cs-light-font-color: #000;
    }
    </style>
<style>
.cs_top_menu_item {
  font-size: 0.88rem;
}
div.dropdown {
  -moz-transform: translateY(-1px);
}
</style>
<!-- CodeMirror -->
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/codemirror.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/mode/python/python.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/addon/fold/foldcode.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/addon/fold/foldgutter.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/addon/fold/indent-fold.js" type="text/javascript"></script>
<link href="https://py.mit.edu/_static/_base/scripts/codemirror/codemirror.css" rel="stylesheet"/>
<link href="https://py.mit.edu/_static/_base/scripts/codemirror/addon/fold/foldgutter.css" rel="stylesheet"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
</head>
<body style="margin: 0px;">
<header id="cs_header">
<div class="nav-container">
<div class="cs_header_text"><a href="https://py.mit.edu/fall20"><img src="https://py.mit.edu/_static/fall20/logo.gif"/> 6.009</a></div>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/information">Information/Policies</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/progress">Progress</a>
<div class="dropdown" onmouseleave="clearMenu(this);">
<label class="dropbtn cs_top_menu_item" for="cs_menu_e92315598caf37074f1c2542f0bc9c06">Help<span class="downarrow">▼</span></label>
<input checked="false" class="dropdown-checkbox" id="cs_menu_e92315598caf37074f1c2542f0bc9c06" type="checkbox"/>
<div class="dropdown-content">
<a class="cs_top_menu_item" href="https://py.mit.edu/forum">Forum</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/queue/">Help Queue</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/python">Accessing/Installing Python</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/notes">Course Notes</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/otherhelp">Other Help</a></div></div>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/labs/lab8?loginaction=login">Log In</a><a class="icon" href="javascript:void(0);" onclick="toggleResponsiveHeader()">☰</a>
</div>
</header>
<div class="cs_navigation cs_top_navigation" id="cs_top_navigation"><span class="line"><a href="https://py.mit.edu/fall20">Home</a></span> <span class="cs_nav_separator">/</span> <span class="line"><a href="https://py.mit.edu/fall20/labs/lab8">Lab 8: Symbolic Algebra</a></span></div>
<main class="cs_body" id="cs_body">
<div class="cs_left_menu"></div>
<div class="cs_content">
<div class="cs_page_body">
<center><h1 class="cs_content_header">Lab 8: Symbolic Algebra</h1></center>
<center>The questions below are due on Friday November 06, 2020; 04:00:00 PM.<br/> <br/></center><div class="response" id="catsoop_login_box">
<b><center>You are not logged in.</center></b><br/>
If you are a current student, please <a href="https://py.mit.edu/fall20/labs/lab8?loginaction=login">Log
In</a> for full access to the web site.<br/>Note that this link will take you to
an external site (<tt>https://shimmer.mit.edu</tt>) to authenticate, and then you will be redirected
back to this page.
</div>
<a class="anchor" name="catsoop_section_1"></a><a class="anchor" name="_preparation"></a><h2 class="cs_section_title">1) Preparation<a class="cs_permalink" href="#_preparation">§</a></h2>
<div class="callout callout-note"><div class="callout-title">Note</div>
<p>You may wish to read the whole lab before implementing
any code, so that you can make a more complete plan before diving in.  Try
making a plan for your code, including the following:</p><ul>
<li>Which classes are you going to implement?  Which classes are subclasses of which classes?</li>
<li>What attributes are stored in each class?</li>
<li>What methods does each class have?</li>
</ul><p>As you work through, be on the lookout for opportunities to take advantage
of inheritance to avoid repetitious code!</p><p>Throughout the lab, you should not use Python's <code>eval</code>,
<code>exec</code>, <code>isinstance</code>, or <code>type</code> built-ins,
except where we have indicated that it is okay to do so.</p>
</div>
<p>This lab assumes you have Python 3.6 or later installed on your machine.</p>
<p>The following file contains code and other resources as a starting point for
this lab: <a download="lab8.zip" href="https://py.mit.edu/fall20/lab_distribution.zip?path=%5B%22fall20%22%2C+%22labs%22%2C+%22lab8%22%5D"><tt>lab8.zip</tt></a></p>
<p>Most of your changes should be made to <code>lab.py</code>, which you will submit
at the end of this lab.  Importantly, you should not add any imports
to the file.</p>
<p>You can also see and participate in online discussion about this lab in the <a href="https://py.mit.edu/forum/c/labs/lab-8" target="_blank">"Lab 8"
Category</a> in the forum.</p>
<p>This lab is worth a total of 4 points.  Your score for the lab is based on:</p>
<ul>
<li>passing the test cases from <code>test.py</code> under the time limit (1.5 points), and</li>
<li>a brief "checkoff" conversation with a staff member to discuss your code (2.5 points).</li>
</ul>
<p>For this lab, you will only receive credit for a test case if it runs to
completion under the time limit on the server.</p>
<p>Please also review the <a href="https://py.mit.edu/fall20/information#catsoop_section_6">collaboration policy</a> before continuing.</p>
<p><strong>This lab does not have any questions that are due before lecture, but you are
strongly encouraged to read the specification, and perhaps to get started with
trying to implement some of the code, before lecture on 2 November.  The questions
below are all due on Friday, 6 Nov at 4pm Eastern.</strong></p>
<a class="anchor" name="catsoop_section_2"></a><a class="anchor" name="_introduction"></a><h2 class="cs_section_title">2) Introduction<a class="cs_permalink" href="#_introduction">§</a></h2>
<p>In this lab, we will develop a Python framework for symbolic algebra.  In such
a system, algebraic expressions including variables and numbers are not
immediately evaluated but rather are stored in symbolic form.</p>
<p>We'll start by implementing support for basic arithmetic (<code>+</code>, <code>-</code>, <code>*</code>, and
<code>/</code>) on variables and numbers, and then we'll add support for simplification
and differentiation of these symbolic expressions.  Ultimately, this system
will be able to support interactions such as the following:</p>
<pre><code class="language-py">&gt;&gt;&gt; x = Var('x')
&gt;&gt;&gt; y = Var('y')
&gt;&gt;&gt; print(x + y)
x + y
&gt;&gt;&gt; z = x + 2*x*y + x
&gt;&gt;&gt; print(z)
x + 2 * x * y + x
&gt;&gt;&gt; print(z.deriv('x'))
1 + 2 * x * 0 + y * (2 * 1 + x * 0) + 1
&gt;&gt;&gt; print(z.deriv('x').simplify())
1 + y * 2 + 1
&gt;&gt;&gt; print(z.deriv('x'))
1 + 2 * x * 0 + y * (2 * 1 + x * 0) + 1
&gt;&gt;&gt; print(z.deriv('y'))
0 + 2 * x * 1 + y * (2 * 0 + x * 0) + 0
&gt;&gt;&gt; print(z.deriv('y').simplify())
2 * x
&gt;&gt;&gt; z.eval({'x': 3, 'y': 7})
48
</code></pre>
<a class="anchor" name="catsoop_section_3"></a><a class="anchor" name="_basic_symbols"></a><h2 class="cs_section_title">3) Basic Symbols<a class="cs_permalink" href="#_basic_symbols">§</a></h2>
<p>In this week's code distribution, we have provided a very minimal skeleton,
containing a small definition for three classes:</p>
<ul>
<li><code>Symbol</code> will be our base class; all other classes we create will inherit from this class, and any behavior that is common between all expressions (that is, all behavior that is not unique to a particular <em>kind</em> of symbolic expression) should be implemented here.</li>
<li>Instances of <code>Var</code> represent variables (such as <span class="cs_math_to_render">x</span> or <span class="cs_math_to_render">y</span>).</li>
<li>Instances of <code>Num</code> represent numbers within symbolic expressions.</li>
</ul>
<p>Take a look at the <code>Var</code> and <code>Num</code> classes.  Note that each has <code>__init__</code>,
<code>__repr__</code>, and <code>__str__</code> defined for you already.</p>
<a class="anchor" name="catsoop_section_4"></a><a class="anchor" name="_binary_operations"></a><h2 class="cs_section_title">4) Binary Operations<a class="cs_permalink" href="#_binary_operations">§</a></h2>
<p>So far, our system is somewhat uninteresting.  It lets us represent variables
and numbers, but in order to be able to represent meaningful expressions, we
also need ways of combining these primitive symbols together.  In particular,
we will represent these kinds of combinations as <em>binary operations</em>.  You
should implement a class called <code>BinOp</code> to represent a binary operation.
Because it is a type of symbolic expression, <code>BinOp</code> should be a subclass of
<code>Symbol</code>.</p>
<p>We will implement four subclasses of <code>BinOp</code>:</p>
<ul>
<li><code>Add</code>, to represent an addition</li>
<li><code>Sub</code>, to represent a subtraction</li>
<li><code>Mul</code>, to represent a multiplication</li>
<li><code>Div</code>, to represent a division</li>
</ul>
<p>By virtue of being binary operations, each instance of any of these classes
should have two instance variables:</p>
<ul>
<li><code>left</code>: a <code>Symbol</code> instance representing the left-hand operand</li>
<li><code>right</code>: a <code>Symbol</code> instance representing the right-hand operand</li>
</ul>
<p>For example, <code>Add(Add(Var('x'), Num(3)), Num(2))</code> represents the symbolic
expression <span class="cs_math_to_render">x + 3 + 2</span>.  The <code>left</code> attribute of this instance should be the
<code>Add</code> instance variable <code>Add(Var('x'), Num(3))</code>, and the <code>right</code> attribute
should be the <code>Num</code> instance <code>Num(2)</code>.</p>
<div class="question"><b>Check Yourself:</b><p>The structure of each of these classes' <code>__init__</code> methods is likely to be
almost the same (if not exactly the same).  What does that suggest about
how/where you should implement <code>__init__</code>?</p><p><span id="queue_checkyourself_1"></span></p></div>
<p>These constructors should also accept integers, floats, or strings as their arguments.
<code>Add(2, 'x')</code>, for example, should create an instance <code>Add(Num(2), Var('x'))</code>.
<strong>It is okay to use <code>isinstance</code> or <code>type</code> in this context, to check if the
arguments passed to the constructor are strings or numbers.</strong></p>
<a class="anchor" name="catsoop_section_5"></a><a class="anchor" name="_display"></a><h2 class="cs_section_title">5) Display<a class="cs_permalink" href="#_display">§</a></h2>
<p>As of right now, attempting to print an instance of <code>BinOp</code> (or a subclass
thereof) will not really tell us much useful information.  In this section,
we'll improve on Python's ability to display these objects.</p>
<p>Python has two different ways to get a representation of an object as
a string. First, <code>repr(obj)</code> (which calls <code>obj.__repr__()</code> under-the-hood) should
produce a string containing a representation that, when passed back into
Python, would evaluate to an equivalent object. Second, <code>str(obj)</code> (which calls
<code>obj.__str__()</code> under-the-hood) should produce a human-readable string
representation.</p>
<div class="question"><b>Check Yourself:</b><p>Take a look at the <code>__repr__</code> and <code>__str__</code> methods in <code>Var</code> and <code>Num</code>.  What
is the difference between them?</p><p><span id="queue_checkyourself_2"></span></p></div>
<p>Implement <code>__repr__</code> and <code>__str__</code> in appropriate places (avoiding repeating
code where possible), such that, for any symbolic expression <code>sym</code>, <code>repr(sym)</code>
will produce a string containing a Python expression that, when evaluated,
will result in a symbolic expression equivalent to <code>sym</code>.  Similarly, <code>str(sym)</code>
should produce a human-readable representation, given by
<code>left_string + ' ' + operand + ' ' + right_string</code>, where <code>left_string</code> and <code>right_string</code> are the
string representations of the <code>left</code> and <code>right</code> attributes, respectively, and
<code>operand</code> is a string representation of the operand associated with the
specific class in question.  For example:</p>
<pre><code class="language-py">&gt;&gt;&gt; z = Add(Var('x'), Sub(Var('y'), Num(2)))
&gt;&gt;&gt; repr(z)  # notice that this result, if fed back into Python, produces an equivalent object.
"Add(Var('x'), Sub(Var('y'), Num(2)))"
&gt;&gt;&gt; str(z)  # this result cannot necessarily be fed back into Python, but it looks nicer.
'x + y - 2'
</code></pre>
<p>As always, try to avoid repetitious code when implementing!  You may wish to
store additional class and/or instance variables in the subclasses of <code>BinOp</code>
in order to accomplish this.  For example, we need a way to look up a string
representing the associated operator for each of the supported operations.</p>
<p><a class="anchor" name="catsoop_section_5_1"></a><a class="anchor" name="_parenthesization"></a><h3 class="cs_section_title">5.1) Parenthesization<a class="cs_permalink" href="#_parenthesization">§</a></h3></p>
<p>Note that, while a <code>__repr__</code> implementation that follows the rules described
above works well for complicated expressions (as seen in the expressions
in the last example above), a <code>__str__</code> implementation that
follows those rules results in some possible ambiguities or erroneous
interpretations.  In particular, consider the expression
<code>Mul(Var('x'), Add(Var('y'), Var('z')))</code>.  According to the rules above for
<code>__str__</code>, that
expression's string representation would be <code>"x * y + z"</code>, but the internal
structure of the expression suggests something different!  It would be nice for
the string representation instead to be <code>"x * (y + z)"</code>, to better align with the
actual structure represented by the expression.</p>
<p>To address this, we add rules for parenthesization as follows, where <code>B</code> is the <code>BinOp</code>
instance whose string representation we are finding<a class="anchor" name="catsoop_footnote_ref_1"></a><a href="#catsoop_footnote_1"><sup>1</sup></a>:</p>
<ul>
<li>If <code>B.left</code> and/or <code>B.right</code>
themselves represent expressions with lower precedence than <code>B</code>, wrap their string
representations in parentheses (here, precedence is defined using the
standard
"<a href="https://en.wikipedia.org/wiki/Order_of_operations#Mnemonics)" target="_blank">PEMDAS</a>"
ordering).</li>
<li>As a special case, if <code>B</code> represents a subtraction or a division and <code>B.right</code>
represents an expression with <em>the same precedence</em> as <code>B</code>, wrap <code>B.right</code>'s string
representation in parentheses.</li>
</ul>
<p>Individual numbers or variables should never be wrapped in parentheses.</p>
<div class="question"><b>Check Yourself:</b><p>Think about the rules for parenthesization described above in terms of algebraic expressions and
work through parenthesizing some example expressions by hand to get a feel for
how these rules work.  Do these rules seem to work in a general sense -- will they
always work across
different operations and across different levels of expression complexity?  Why do
they work?  Why are subtraction and division treated differently from addition
and multiplication?</p><p><span id="queue_checkyourself_3"></span></p></div>
<p>Note that information about concrete syntax (including parenthesization) should
not be explicitly stored in any of your instances; grouping should be reflected
in the structure of your objects and the connections between them.</p>
<a class="anchor" name="catsoop_section_6"></a><a class="anchor" name="_python_integration"></a><h2 class="cs_section_title">6) Python Integration<a class="cs_permalink" href="#_python_integration">§</a></h2>
<p>Entering expressions of the form <code>Add(Var('x'), Add(Num(3), Num(2)))</code> can get a
little bit tedious.  It would be much nicer, for example, to be able to enter
that expression as <code>Var('x') + Num(3) + Num(2)</code>.</p>
<p>Add methods to appropriate class(es) in your file such that, for any
arbitrary symbolic expressions <code>E1</code> and <code>E2</code>:</p>
<ul>
<li><code>E1 + E2</code> results in an instance <code>Add(E1, E2)</code><br/>(note: you can override the behavior of <code>+</code> with the <code>__add__</code> and <code>__radd__</code> "dunder" methods)</li>
<li><code>E1 - E2</code> results in an instance <code>Sub(E1, E2)</code><br/>(note: you can override the behavior of <code>-</code> with the <code>__sub__</code> and <code>__rsub__</code> "dunder" methods)</li>
<li><code>E1 * E2</code> results in an instance <code>Mul(E1, E2)</code><br/>(note: you can override the behavior of <code>*</code> with the <code>__mul__</code> and <code>__rmul__</code> "dunder" methods)</li>
<li><code>E1 / E2</code> results in an instance <code>Div(E1, E2)</code><br/>(note: you can override the behavior of <code>/</code> with the <code>__truediv__</code> and <code>__rtruediv__</code> "dunder" methods)</li>
</ul>
<div class="question"><b>Check Yourself:</b><p>Try to avoid duplicating code when implementing these behaviors!  In what
class(es) should you implement <code>__add__</code>?</p><p><span id="queue_checkyourself_4"></span></p></div>
<p>These behaviors should work so long as <em>at least one</em> of <code>E1</code> and <code>E2</code> is a
symbolic expression and the other is either a symbolic expression, a number,
or a string.</p>
<p>For example:</p>
<pre><code class="language-py">&gt;&gt;&gt; Var('a') * Var('b')
Mul(Var('a'), Var('b'))
&gt;&gt;&gt; 2 + Var('x')
Add(Num(2), Var('x'))
&gt;&gt;&gt; Num(3) / 2
Div(Num(3), Num(2))
&gt;&gt;&gt; Num(3) + 'x'
Add(Num(3), Var('x'))
</code></pre>
<a class="anchor" name="catsoop_section_7"></a><a class="anchor" name="_derivatives"></a><h2 class="cs_section_title">7) Derivatives<a class="cs_permalink" href="#_derivatives">§</a></h2>
<p>Next, we'll make the computer do our 18.01 homework for us.  Well, not quite.
But we'll implement support for symbolic differentiation.  In particular, we
would like to implement the following rules for partial derivatives (where <span class="cs_math_to_render">x</span>
is an arbitrary variable, <span class="cs_math_to_render">c</span> is a constant or a variable other than <span class="cs_math_to_render">x</span>, and
<span class="cs_math_to_render">u</span> and <span class="cs_math_to_render">v</span> are arbitrary expressions):</p>
<p><div class="cs_displaymath cs_math_to_render" style="text-align:center;padding-bottom:10px;">\frac{\partial}{\partial x}c = 0</div></p>
<p><div class="cs_displaymath cs_math_to_render" style="text-align:center;padding-bottom:10px;">\frac{\partial}{\partial x}x = 1</div></p>
<p><div class="cs_displaymath cs_math_to_render" style="text-align:center;padding-bottom:10px;">\frac{\partial}{\partial x}\left(u + v\right) = \frac{\partial}{\partial x}u + \frac{\partial}{\partial x}v</div></p>
<p><div class="cs_displaymath cs_math_to_render" style="text-align:center;padding-bottom:10px;">\frac{\partial}{\partial x}\left(u\cdot v\right) = u\left(\frac{\partial}{\partial x}v\right) + v\left(\frac{\partial}{\partial x}u\right)</div></p>
<p><div class="cs_displaymath cs_math_to_render" style="text-align:center;padding-bottom:10px;">\frac{\partial}{\partial x}\left(\frac{u}{v}\right) = \frac{v\left(\frac{\partial}{\partial x}u\right) - u\left(\frac{\partial}{\partial x}v\right)}{v^2}</div></p>
<p>Even though it may not be obvious from looking at first glance, these
mathematical definitions are recursive! That is to say, partial derivatives of
compound expressions are defined in terms of partial derivatives of component
parts.</p>
<p>Implement differentiation by adding a method called <code>deriv</code> to your classes.
This method should take a single argument (a string containing the name of the
variable with respect to which we are differentiating), and it should return a
symbolic expression representing the result of the differentiation.  For example:</p>
<pre><code class="language-py">&gt;&gt;&gt; x = Var('x')
&gt;&gt;&gt; y = Var('y')
&gt;&gt;&gt; z = 2*x - x*y + 3*y
&gt;&gt;&gt; print(z.deriv('x'))  # unsimplified, but the following gives us (2 - y)
2 * 1 + x * 0 - (x * 0 + y * 1) + 3 * 0 + y * 0
&gt;&gt;&gt; print(z.deriv('y'))  # unsimplified, but the following gives us (-x + 3)
2 * 0 + x * 0 - (x * 1 + y * 0) + 3 * 1 + y * 0
</code></pre>
<a class="anchor" name="catsoop_section_8"></a><a class="anchor" name="_simplification"></a><h2 class="cs_section_title">8) Simplification<a class="cs_permalink" href="#_simplification">§</a></h2>
<p>The above code works, but it leads to output that is not very readable (it is
very difficult to see, for example, that the above examples correspond to <span class="cs_math_to_render">2-y</span>
and <span class="cs_math_to_render">-x+3</span>, respectively).  To help with this, implement a method called
<code>simplify</code> to your class(es).  <code>simplify</code> should take no arguments, and it
should return a simplified form of the expression, according to the following
rules:</p>
<ul>
<li>Any binary operation on two numbers should simplify to a single number containing the result.</li>
<li>Adding <span class="cs_math_to_render">0</span> to (or subtracting <span class="cs_math_to_render">0</span> from) any expression <span class="cs_math_to_render">E</span> should simplify to <span class="cs_math_to_render">E</span>.</li>
<li>Multiplying or dividing any expression <span class="cs_math_to_render">E</span> by <span class="cs_math_to_render">1</span> should simplify to <span class="cs_math_to_render">E</span>.</li>
<li>Multiplying any expression <span class="cs_math_to_render">E</span> by <span class="cs_math_to_render">0</span> should simplify to <span class="cs_math_to_render">0</span>.</li>
<li>Dividing <span class="cs_math_to_render">0</span> by any expression <span class="cs_math_to_render">E</span> should simplify to <span class="cs_math_to_render">0</span>.</li>
<li>A single number or variable always simplifies to itself.</li>
</ul>
<div class="question"><b>Check Yourself:</b><p>Think about the simplification rules described above in terms of algebraic expressions and
work through simplifying some example expressions by hand to get a feel for how
these rules work.  Do these rules seem to work in a general sense -- will they always
work across our different operations and across different levels of expression complexity,
producing sensible simplifications?
Why?</p><p><span id="queue_checkyourself_5"></span></p></div>
<p>Within <code>simplify</code>, you are welcome to use <code>isinstance</code> or <code>type</code> to check
whether both subexpressions of a binary operation are instances of <code>Num</code>.</p>
<p>Your simplification method does not need to handle cases like <span class="cs_math_to_render">3 + (x + 2)</span>,
where the terms that could be combined are separated from each other in the
tree.</p>
<p>For example, continuing from above:</p>
<pre><code class="language-py">&gt;&gt;&gt; z = 2*x - x*y + 3*y
&gt;&gt;&gt; print(z.simplify())
2 * x - x * y + 3 * y
&gt;&gt;&gt; print(z.deriv('x'))
2 * 1 + x * 0 - (x * 0 + y * 1) + 3 * 0 + y * 0
&gt;&gt;&gt; print(z.deriv('x').simplify())
2 - y
&gt;&gt;&gt; print(z.deriv('y'))
2 * 0 + x * 0 - (x * 1 + y * 0) + 3 * 1 + y * 0
&gt;&gt;&gt; print(z.deriv('y').simplify())
0 - x + 3
&gt;&gt;&gt; Add(Add(Num(2), Num(-2)), Add(Var('x'), Num(0))).simplify()
Var('x')
</code></pre>
<p>Note, also, that your <code>simplify</code> method should work by creating a new instance
to represent the simplified form, rather than mutating the instance from which
<code>simplify</code> was called.</p>
<a class="anchor" name="catsoop_section_9"></a><a class="anchor" name="_evaluation"></a><h2 class="cs_section_title">9) Evaluation<a class="cs_permalink" href="#_evaluation">§</a></h2>
<p>Next, we'll add support for evaluating expressions for particular values of
variables.  Add method(s) to your class(es) such that, for any symbolic
expression <code>sym</code>, <code>sym.eval(mapping)</code> will find a numerical value for the given
expression.  <code>mapping</code> should be a dictionary mapping variable names to values.
For example:</p>
<pre><code class="language-py">&gt;&gt;&gt; z = Add(Var('x'), Sub(Var('y'), Mul(Var('z'), Num(2))))
&gt;&gt;&gt; z.eval({'x': 7, 'y': 3, 'z': 9})
-8
&gt;&gt;&gt; z.eval({'x': 3, 'y': 10, 'z': 2})
9
</code></pre>
<p>In the test cases we'll run, the given dictionary will always contain all of
the bindings needed to evaluate the expression fully.  What should your code do
in the case where the expression contains a variable not present in the given
<code>mapping</code> dictionary?</p>
<a class="anchor" name="catsoop_section_10"></a><a class="anchor" name="_parsing_symbolic_expressions"></a><h2 class="cs_section_title">10) Parsing Symbolic Expressions<a class="cs_permalink" href="#_parsing_symbolic_expressions">§</a></h2>
<p>Finally, we would like to support parsing strings into symbolic expressions (to
provide yet another means of input).  For example, we would like to do
something like:</p>
<pre><code class="language-py">&gt;&gt;&gt; sym('(x * (2 + 3))')
Mul(Var('x'), Add(Num(2), Num(3)))
</code></pre>
<p>Define a stand-alone function called <code>sym</code>, which takes a single string as input.  This string should contain either:</p>
<ul>
<li>a single variable name,</li>
<li>a single number, or</li>
<li>a fully parenthesized expression of the form <code>(E1 op E2)</code>, representing a binary operation (where <code>E1</code> and <code>E2</code> are themselves strings representing expressions, and <code>op</code> is one of <code>+</code>, <code>-</code>, <code>*</code>, or <code>/</code>).</li>
</ul>
<p>You may assume that the string is always well-formed and fully parenthesized
(you do not need to handle erroneous input), but it should work for arbitrarily
deep nesting of expressions.</p>
<p>This process is often broken down into two pieces: <em>tokenizing</em> (to break the input string into meaningful units) and <em>parsing</em> (to build our internal representation from those units).</p>
<p><a class="anchor" name="catsoop_section_10_1"></a><a class="anchor" name="_tokenizing"></a><h3 class="cs_section_title">10.1) Tokenizing<a class="cs_permalink" href="#_tokenizing">§</a></h3></p>
<p>A good helper function to write is <code>tokenize</code>, which should take a string as
described above as input and should output a list of meaningful <em>tokens</em>
(parentheses, variable names, numbers, or operands).</p>
<p>For our purposes, you may assume that variables are always single-character
alphabetic characters, that all numbers are integers, and you may also assume
that there are spaces separating operands and operators.</p>
<p>As an example:</p>
<pre><code class="language-py">&gt;&gt;&gt; tokenize("(x * (2 + 3))")
['(', 'x', '*', '(', '2', '+', '3', ')', ')']
</code></pre>
<p>Note that your code should also be able to handle numbers with more than one
digit and negative numbers!  A number like -200, for example, should be
represented by a single token <code>'-200'</code>.</p>
<p><a class="anchor" name="catsoop_section_10_2"></a><a class="anchor" name="_parsing"></a><h3 class="cs_section_title">10.2) Parsing<a class="cs_permalink" href="#_parsing">§</a></h3></p>
<p>Another helper function, <code>parse</code>, could take the output of <code>tokenize</code> and
convert it into an appropriate instance of <code>Symbol</code> (or some subclass thereof).
For example:</p>
<pre><code class="language-py">&gt;&gt;&gt; tokens = tokenize("(x * (2 + 3))")
&gt;&gt;&gt; parse(tokens)
Mul(Var('x'), Add(Num(2), Num(3)))
</code></pre>
<p>Our "little language" for representing symbolic expressions can be parsed using
a <em>recursive-descent</em> parser.  One way to structure <code>parse</code> is as follows:</p>
<pre><code class="language-py">def parse(tokens):
   def parse_expression(index):
       pass  # your code here
   parsed_expression, next_index = parse_expression(0)
   return parsed_expression
</code></pre>
<p>The function <code>parse_expression</code> is a recursive function that takes as an argument an integer into the <code>tokens</code> list and returns a pair of values:</p>
<ul>
<li>the expression found starting at the location given by <code>index</code> (an instance of one of the <code>Symbol</code> subclasses), and</li>
<li>the index beyond where this expression ends (i.e., if the expression ends at the token with index <code>6</code> in the <code>tokens</code> list, then the returned value should be <code>7</code>.</li>
</ul>
<p>In the definition of this procedure, we make sure that we call it with the value <code>index</code> corresponding to the start of an expression.  So, we need to handle three cases.  Let <code>token</code> be the token at location <code>index</code>; the cases are:</p>
<ul>
<li>
<p><strong>Number</strong>: If <code>token</code> represents an integer, then make a corresponding <code>Num</code> instance and return that, paired with <code>index + 1</code> (since a number is represented by a single token).</p>
</li>
<li>
<p><strong>Variable</strong>: If <code>token</code> represents a variable name (a single alphabetic character), then make a corresponding <code>Var</code> instance and return that, paired with <code>index + 1</code> (since a variable is represented by a single token).</p>
</li>
<li>
<p><strong>Operation</strong>: Otherwise, the sequence of tokens starting at <code>index</code> must be of the form: <code>(E1 op E2)</code>.  Therefore, <code>token</code> must be <code>(</code>.  In this case, we need to recursively parse the two subexpressions, combine them into an appropriate instance of a subclass of <code>BinOp</code> (determined by <code>op</code>), and return that instance, along with the index of the token beyond the final right parenthesis.</p>
</li>
</ul>
<p>Implement the <code>sym</code> function in your code (possibly using the helper functions
described above).  <strong>Your implementation of the function <code>sym</code> should not use
Python's built-in <code>eval</code>, <code>exec</code>, <code>type</code>, or <code>isinstance</code> functions.</strong></p>
<a class="anchor" name="catsoop_section_11"></a><a class="anchor" name="_code_submission"></a><h2 class="cs_section_title">11) Code Submission<a class="cs_permalink" href="#_code_submission">§</a></h2>
<p>
<!--START question code -->
<div class="question question-lab009" id="cs_qdiv_code" style="position: static">
<div id="code_rendered_question">
<input id="code" name="code" style="display: none" type="file"/><button class="btn btn-catsoop" id="code_select_button">Select File</button> <tt><span id="code_selected_file">No file selected</span></tt>
<script type="text/javascript">
document.getElementById('code').value = '';
document.getElementById('code_select_button').addEventListener('click', function (){
    document.getElementById("code").click();
});
document.getElementById('code').addEventListener('change', function (){
    document.getElementById('code_selected_file').innerText = document.getElementById('code').value;
});
</script>
</div><div>
<span id="code_buttons"></span>
<span id="code_loading_wrapper">
<span id="code_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="code_score_display"></span>
<div class="nsubmits_left" id="code_nsubmits_left"></div></div>
<div id="code_solution_container">
<div id="code_solution">
</div>
<div id="code_solution_explanation">
</div>
</div>
<div id="code_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Friday November 06, 2020 at 04:00:00 PM Eastern time.</span></div>
<!--END question code -->
</p>
<style>
.impsolution{display:none;}
</style>
<a class="anchor" name="catsoop_section_12"></a><a class="anchor" name="_checkoff"></a><h2 class="cs_section_title">12) Checkoff<a class="cs_permalink" href="#_checkoff">§</a></h2>
<p>Once you are finished with the code, please come to
office hours and add yourself to the queue asking for a checkoff.  <strong>You must be
ready to discuss your code and test cases in detail before asking for a checkoff.</strong></p>
<p>You should be prepared to demonstrate your code (which should be
well-commented, should avoid repetition, and should make good use of helper
functions).  In particular, be prepared to discuss:</p>
<ul>
<li>Your implementation of parenthesization, including using inheritance to avoid repetitious code.</li>
<li>Your implementation of <code>deriv</code>, including using inheritance to avoid repetitious code.</li>
<li>Your implementation of <code>simplify</code>, including using inheritance to avoid repetitious code.</li>
<li>Your implementation of <code>eval</code>, including using inheritance to avoid repetitious code.</li>
<li>Your implementation of <code>sym</code>.</li>
<li>A demonstration of using your code to simulate some symbolic-algebra problems of your own choosing.</li>
<li>A brief explanation of the rules for parenthesization and simplification and why those rules work.</li>
</ul>
<p><a class="anchor" name="catsoop_section_12_1"></a><a class="anchor" name="_grade"></a><h3 class="cs_section_title">12.1) Grade<a class="cs_permalink" href="#_grade">§</a></h3></p>
<div class="response"><i>You have not yet received this checkoff.  When you have completed this checkoff, you will see a grade here.</i></div>
<script src="https://py.mit.edu/_static/_handler/default/cs_ajax.js" type="text/javascript"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
catsoop.all_questions = ['code'];
catsoop.username = null;
catsoop.api_token = null;
catsoop.this_path = 'https://py.mit.edu/fall20/labs/lab8';
catsoop.path_info = ['fall20', 'labs', 'lab8'];
catsoop.course = 'fall20';
catsoop.url_root = 'https://py.mit.edu';
catsoop.imp = '';
catsoop.skip_alert = [];
catsoop.viewans_confirm = "Are you sure?  Viewing the answer will prevent any further submissions to this question.  Press 'OK' to view the answer, or press 'Cancel' if you have changed your mind.";

// @license-end</script>
<br/> <hr/><b name="cs_footnotes">Footnotes</b><p><a class="anchor" name="catsoop_footnote_1"></a><sup style="padding-right:0.25em;color:var(--cs-base-bg-color);">1</sup>Note that these
rules should be sufficient for the four operations we have implemented.  If we
wanted to add additional operations, we may need to reconsider these
rules. <a href="#catsoop_footnote_ref_1"><span class="noprint">(click to return to text)</span></a></p>
</div>
</div>
<div class="cs_right_menu"></div>
</main>
<footer>
<div class="cs_navigation cs_bottom_navigation" id="cs_bottom_navigation"><span class="line"><a href="https://py.mit.edu/fall20">Home</a></span> <span class="cs_nav_separator">/</span> <span class="line"><a href="https://py.mit.edu/fall20/labs/lab8">Lab 8: Symbolic Algebra</a></span></div>
<div class="cs_footer">
      This page was last updated on Monday November 09, 2020 at 12:24:37 AM (revision <code>12735549</code>).<br/> <br/>
<pre class="catsooplogo" style="font-size:50%;">\            
/    /\__/\  
\__=(  o_O )=
(__________) 
 |_ |_ |_ |_ </pre>
      Powered by <a href="https://catsoop.mit.edu" target="_blank">CAT-SOOP</a> v2021.2.0.dev1971+hg ("Devon Rex" development snapshot).<br/>
      CAT-SOOP is <a href="https://www.fsf.org/about/what-is-free-software" target="_blank">Free/Libre Software</a>, available under the terms<br/>of the <a href="https://py.mit.edu/_util/license" target="_blank">GNU Affero General Public License, version 3</a>.<br/>
<a download="" href="https://py.mit.edu/_util/source.zip" target="_blank">Download Source Code</a><br/>
<a href="https://py.mit.edu/_util/jslicense.html" rel="jslicense" target="_blank">Javascript License Information</a>
</div>
</footer>
</body>
</html>

