<!DOCTYPE html>

<html>
<head>
<!-- This page was generated by CAT-SOOP 2021.2.0.dev1971+hg.  miau. -->
<meta charset="utf-8"/>
<title>Lab 2: Image Processing, Part 2 | 6.009 Fall 2020</title>
<link href="https://py.mit.edu/_static/fall20/logo.gif" rel="icon" type="image/gif"/>
<!-- include catsoop base css -->
<link href="https://py.mit.edu/_static/_base/themes/base.css" rel="stylesheet" type="text/css"/>
<!-- set up JS namespace for catsoop -->
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    var catsoop = {plugins: {}};

    function toggleResponsiveHeader(){
        document.getElementsByTagName('header')[0].classList.toggle('responsive');
    }

    window.addEventListener('DOMContentLoaded', function(){
        var menu_boxes = document.getElementsByClassName('dropdown-checkbox');
        for(var i=0; i<menu_boxes.length; i++){
            menu_boxes[i].checked = false;
        }
    });

    function clearMenu(menu){
       menu.children[1].checked = false;
    }
    // @license-end
    </script>
<!-- load in katex and CAT-SOOP-specific math rendering  -->
<script src="https://py.mit.edu/_static/_base/scripts/katex/katex.min.js" type="text/javascript"></script>
<link href="https://py.mit.edu/_static/_base/scripts/katex/katex.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    catsoop.katex_macros = {};
    catsoop.render_math = function (elt) {
        var tex = elt.innerText; // TeX Source
        var display = elt.classList.contains('cs_displaymath');
        try {
            katex.render(tex, elt, {displayMode: display, macros: catsoop.katex_macros});
        }catch(e) {
            console.log(e);
            elt.innerHTML = "<font color='red'><b>Could not parse math:</b> <tt>" + tex + "</tt></font>";
        }
        elt.classList.remove('cs_math_to_render');
    }


    catsoop.render_all_math = function (elt){
        var mathelts = elt.getElementsByClassName('cs_math_to_render');
        while(mathelts.length > 0){
            catsoop.render_math(mathelts[0]);
        }
    }
    document.addEventListener("DOMContentLoaded", function(event) {
          catsoop.render_all_math(document);
    });
    // @license-end
    </script>
<!-- load in diagram stuff -->
<script src="https://py.mit.edu/_static/_base/scripts/cs_diagrams.js" type="text/javascript"></script>
<script type="text/javascript">
        catsoop.diagram_sources = {};
    </script>
<!-- Syntax Highlighting -->
<script src="https://py.mit.edu/_static/_base/scripts/highlight/highlight.min.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/highlightjs-line-numbers.js" type="text/javascript"></script>
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    hljs.initHighlightingOnLoad();
    window.addEventListener('DOMContentLoaded', function(){
        document.querySelectorAll('.hl code').forEach((block) => {
            hljs.highlightBlock(block);
        });
        document.querySelectorAll('code.highlight-lines').forEach(function(b){
            hljs.lineNumbersBlock(b);
            if ((b.innerHTML.trim().match(/\r\n|\r|\n/g) || []).length > 0){
                b.parentElement.style = "padding-left: 0px !important;"
                b.classList.add('hljs');
            }
        });
    });
    // @license-end
    </script>
<style>
      :root {
        --cs-base-bg-color: #039bba;
        --cs-light-bg-color: #62d5ed;
        --cs-base-font-color: #fff;
        --cs-light-font-color: #000;
    }
    </style>
<style>
.cs_top_menu_item {
  font-size: 0.88rem;
}
div.dropdown {
  -moz-transform: translateY(-1px);
}
</style>
<!-- CodeMirror -->
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/codemirror.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/mode/python/python.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/addon/fold/foldcode.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/addon/fold/foldgutter.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/addon/fold/indent-fold.js" type="text/javascript"></script>
<link href="https://py.mit.edu/_static/_base/scripts/codemirror/codemirror.css" rel="stylesheet"/>
<link href="https://py.mit.edu/_static/_base/scripts/codemirror/addon/fold/foldgutter.css" rel="stylesheet"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
</head>
<body style="margin: 0px;">
<header id="cs_header">
<div class="nav-container">
<div class="cs_header_text"><a href="https://py.mit.edu/fall20"><img src="https://py.mit.edu/_static/fall20/logo.gif"/> 6.009</a></div>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/information">Information/Policies</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/progress">Progress</a>
<div class="dropdown" onmouseleave="clearMenu(this);">
<label class="dropbtn cs_top_menu_item" for="cs_menu_e92315598caf37074f1c2542f0bc9c06">Help<span class="downarrow">▼</span></label>
<input checked="false" class="dropdown-checkbox" id="cs_menu_e92315598caf37074f1c2542f0bc9c06" type="checkbox"/>
<div class="dropdown-content">
<a class="cs_top_menu_item" href="https://py.mit.edu/forum">Forum</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/queue/">Help Queue</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/python">Accessing/Installing Python</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/notes">Course Notes</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/otherhelp">Other Help</a></div></div>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/labs/lab2?loginaction=login">Log In</a><a class="icon" href="javascript:void(0);" onclick="toggleResponsiveHeader()">☰</a>
</div>
</header>
<div class="cs_navigation cs_top_navigation" id="cs_top_navigation"><span class="line"><a href="https://py.mit.edu/fall20">Home</a></span> <span class="cs_nav_separator">/</span> <span class="line"><a href="https://py.mit.edu/fall20/labs/lab2">Lab 2: Image Processing, Part 2</a></span></div>
<main class="cs_body" id="cs_body">
<div class="cs_left_menu"></div>
<div class="cs_content">
<div class="cs_page_body">
<center><h1 class="cs_content_header">Lab 2: Image Processing, Part 2</h1></center>
<center>The questions below are due on Friday September 18, 2020; 04:00:00 PM.<br/> <br/></center><div class="response" id="catsoop_login_box">
<b><center>You are not logged in.</center></b><br/>
If you are a current student, please <a href="https://py.mit.edu/fall20/labs/lab2?loginaction=login">Log
In</a> for full access to the web site.<br/>Note that this link will take you to
an external site (<tt>https://shimmer.mit.edu</tt>) to authenticate, and then you will be redirected
back to this page.
</div>
<h2>Table of Contents</h2><ul><li><a href="#_preparation">1) Preparation</a></li><li><a href="#_reminders_about_representations_from_lab_1">2) Reminders about Representations From Lab 1</a></li><li><a href="#_introduction">3) Introduction</a></li><ul><li><a href="#_representing_color">3.1) Representing Color</a></li><li><a href="#_code_distribution">3.2) Code Distribution</a></li></ul><li><a href="#_filters_on_color_images">4) Filters on Color Images</a></li><ul><li><a href="#_check_your_results">4.1) Check Your Results</a></li><li><a href="#_other_kinds_of_filters">4.2) Other Kinds of Filters</a></li><li><a href="#_check_your_results_2">4.3) Check Your Results</a></li></ul><li><a href="#_cascade_of_filters">5) Cascade of Filters</a></li><ul><li><a href="#_check_your_results_3">5.1) Check Your Results</a></li></ul><li><a href="#_seam_carving">6) Seam Carving</a></li><ul><li><a href="#_outline_and_description_of_steps">6.1) Outline and Description of Steps</a></li><ul><li><a href="#_graphical_depiction">6.1.1) Graphical Depiction</a></li></ul><li><a href="#_suggested_helper_functions_and_structure">6.2) Suggested Helper Functions and Structure</a></li><li><a href="#_example_with_intermediate_results">6.3) Example with Intermediate Results</a></li><li><a href="#_write_it">6.4) Write It!</a></li><li><a href="#_check_your_results_4">6.5) Check Your Results</a></li></ul><li><a href="#_something_of_your_own">7) Something of Your Own</a></li><li><a href="#_code_submission">8) Code Submission</a></li><li><a href="#_checkoff">9) Checkoff</a></li><ul><li><a href="#_grade">9.1) Grade</a></li></ul></ul>
<a class="anchor" name="catsoop_section_1"></a><a class="anchor" name="_preparation"></a><h2 class="cs_section_title">1) Preparation<a class="cs_permalink" href="#_preparation">§</a></h2>
<p>This lab assumes you have Python 3.6 or later installed on your machine.</p>
<p>As with last week's lab, we will again use the
<a href="https://python-pillow.org/"><code>pillow</code></a> library for loading and
saving images.</p>
<p>The following file contains code and other resources as a starting point for
this lab: <a download="lab2.zip" href="https://py.mit.edu/fall20/lab_distribution.zip?path=%5B%22fall20%22%2C+%22labs%22%2C+%22lab2%22%5D"><tt>lab2.zip</tt></a></p>
<p>Most of your changes should be made to <code>lab.py</code>, which you will submit at the
end of this lab.  Importantly, you should not add any imports to the file, nor
should you use the <code>pillow</code> module for anything other than loading and saving
images (which are already implemented for you).</p>
<p>You can also see and participate in online discussion about this lab in the <a href="https://py.mit.edu/forum/c/labs/lab-2" target="_blank">"Lab 2"
Category</a> in the forum.</p>
<p>This lab is worth a total of 4 points.  Your score for the lab is based on:</p>
<ul>
<li>correctly answering the questions throughout this page, including the image uploads (1 point)</li>
<li>passing the tests in <code>test.py</code> under the server time limit (1 point), and</li>
<li>a brief "checkoff" conversation with a staff member to discuss your work (2 points, part of which is based on <a href="https://py.mit.edu/fall20/notes/style">style</a>).</li>
</ul>
<p>Note that passing all of the tests on the server will require that your code runs reasonably efficiently.</p>
<div class="callout callout-error"><div class="callout-title">Collaboration policy</div>
<p>Please also review the <a href="https://py.mit.edu/fall20/information#_laboratories">collaboration policy</a> before continuing.  Two of your friendly TAs have also made a <a href="https://py.mit.edu/fall20/video?video=collaboration_policy">video</a> demonstrating some "dos" and "don'ts" of lab collaboration in 6.009.</p>
</div>
<p><strong>The questions on this page (including your code submission) are due at 4pm
Eastern on Friday, 18 September.  Checkoffs are due at 10pm Eastern on
Wednesday, 23 September.</strong></p>
<a class="anchor" name="catsoop_section_2"></a><a class="anchor" name="_reminders_about_representations_from_lab_1"></a><h2 class="cs_section_title">2) Reminders about Representations From Lab 1<a class="cs_permalink" href="#_reminders_about_representations_from_lab_1">§</a></h2>
<p>In Lab 1, we introduced a representation for greyscale images, and we
implemented some neat filters to operate on images of that form.  In that lab,
we limited our attention to greyscale images, where we represented brightness
values as integers between 0 (the deepest black) and 255 (the brightest white).</p>
<p>Our filters were represented as Python functions that operated on images (i.e.,
functions that took images as input and produced related images as output).</p>
<p>Before we get into the core of this week's lab, answer the following question
about the small piece of code below, which implements a small
piece of functionality using our representations from last week.</p>
<p>For the following question, consider this piece of code:</p>
<pre><code class="language-py">def make_box(color):
    def create_image(h, w):
        return {'height': h, 'width': w, 'pixels': [color for _ in range(h*w)]}
    return create_image

maker = make_box(40)
im = maker(20, 30)
</code></pre>
<p>
<!--START question pre_lecture -->
<div class="question question-multiplechoice" id="cs_qdiv_pre_lecture" style="position: static">
<div id="pre_lecture_rendered_question">
Which of the following are true statements about the code above?<table border="0">
<tr><td align="center"><input name="pre_lecture_opt0" type="checkbox" value="0"/></td><td>This code has a syntax error.</td></tr>
<tr><td align="center"><input name="pre_lecture_opt1" type="checkbox" value="1"/></td><td>This code does not have a syntax error, but Python will raise an exception when this code is run.</td></tr>
<tr><td align="center"><input name="pre_lecture_opt2" type="checkbox" value="2"/></td><td>This code will run without error.</td></tr>
<tr><td align="center"><input name="pre_lecture_opt3" type="checkbox" value="3"/></td><td><code>make_box</code> is a function of a single argument.</td></tr>
<tr><td align="center"><input name="pre_lecture_opt4" type="checkbox" value="4"/></td><td><code>make_box</code> is a function of two arguments.</td></tr>
<tr><td align="center"><input name="pre_lecture_opt5" type="checkbox" value="5"/></td><td><code>make_box</code> is a dictionary.</td></tr>
<tr><td align="center"><input name="pre_lecture_opt6" type="checkbox" value="6"/></td><td><code>maker</code> is a function of a single argument.</td></tr>
<tr><td align="center"><input name="pre_lecture_opt7" type="checkbox" value="7"/></td><td><code>maker</code> is a function of two arguments.</td></tr>
<tr><td align="center"><input name="pre_lecture_opt8" type="checkbox" value="8"/></td><td><code>maker</code> is a dictionary.</td></tr>
<tr><td align="center"><input name="pre_lecture_opt9" type="checkbox" value="9"/></td><td><code>im</code> is a function of a single argument.</td></tr>
<tr><td align="center"><input name="pre_lecture_opt10" type="checkbox" value="10"/></td><td><code>im</code> is a function of two arguments.</td></tr>
<tr><td align="center"><input name="pre_lecture_opt11" type="checkbox" value="11"/></td><td><code>im</code> is a dictionary.</td></tr>
</table><input id="pre_lecture" name="pre_lecture" type="hidden" value=""/>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
var pre_lecture_selected = {};
document.getElementById("pre_lecture").value = JSON.stringify(pre_lecture_selected);
document.querySelectorAll("input[type=checkbox][name^=pre_lecture_opt]").forEach(function(r){
    r.addEventListener("click", function(){
        pre_lecture_selected[this.getAttribute("name")] = this.checked;
    document.getElementById("pre_lecture").value = JSON.stringify(pre_lecture_selected);
    });
});
// @license-end
</script>
</div><div>
<span id="pre_lecture_buttons"></span>
<span id="pre_lecture_loading_wrapper">
<span id="pre_lecture_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="pre_lecture_score_display"></span>
<div class="nsubmits_left" id="pre_lecture_nsubmits_left"></div></div>
<div id="pre_lecture_solution_container">
<div id="pre_lecture_solution">
</div>
<div id="pre_lecture_solution_explanation">
</div>
</div>
<div id="pre_lecture_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Friday September 18, 2020 at 04:00:00 PM Eastern time.</span></div>
<!--END question pre_lecture -->
</p>
<a class="anchor" name="catsoop_section_3"></a><a class="anchor" name="_introduction"></a><h2 class="cs_section_title">3) Introduction<a class="cs_permalink" href="#_introduction">§</a></h2>
<p>In this lab, we'll continue building on the work from last week's lab,
expanding our little image-processing library to include support for color
images, as well as a few additional interesting filters and features.</p>
<p>At the end of the lab, you'll have an opportunity to implement one or more
additional features of your choosing.</p>
<p><a class="anchor" name="catsoop_section_3_1"></a><a class="anchor" name="_representing_color"></a><h3 class="cs_section_title">3.1) Representing Color<a class="cs_permalink" href="#_representing_color">§</a></h3></p>
<p>In this lab, we will expand our attention from greyscale images to color images.  Although
there are many ways we could choose to represent color images, we will use
a tried-and-true representation, the <a href="https://en.wikipedia.org/wiki/RGB_color_model">RGB color model</a>,
which is used in a lot of common image formats.  In this representation, rather
than a single integer, we will represent the color of each pixel as a tuple of
three integers, representing the amount of red, green, and blue in the pixel,
respectively.  By combining red, green, and blue, we can represent a wide range
of colors.</p>
<p>For this lab, we'll represent an image using a Python dictionary with three keys:</p>
<ul>
<li><code>width</code>: the width of the image (in pixels),</li>
<li><code>height</code>: the height of the image (in pixels), and</li>
<li><code>pixels</code>: a Python list of pixel values, each represented as a tuple of three integers, <code>(r, g, b)</code>, where <code>r</code>, <code>g</code>, and <code>b</code> are all in the range <span class="cs_math_to_render">[0, 255]</span>.  As with last week's lab, these values are stored in
<a href="https://en.wikipedia.org/wiki/Row-major_order">row-major order</a>
(listing the top row left-to-right, then the next row, and so on)</li>
</ul>
<p>For example, consider this <span class="cs_math_to_render">2 \times 3</span> image (enlarged here for clarity):</p>
<center>
<p><img alt="image_sample" src="https://py.mit.edu/_static/fall20/labs/lab2/sample.png"/></p>
</center>
<p>This image would be encoded as the following dictionary:</p>
<pre><code class="language-py">i = {
    'height': 3,
    'width': 2,
    'pixels': [(255, 0, 0), (39, 143, 230), (255, 191, 0),
               (0, 200, 0), (100, 100, 100), (179, 0, 199)],
}
</code></pre>
<p><a class="anchor" name="catsoop_section_3_2"></a><a class="anchor" name="_code_distribution"></a><h3 class="cs_section_title">3.2) Code Distribution<a class="cs_permalink" href="#_code_distribution">§</a></h3></p>
<p>Like last week, we have provided helper functions for loading and saving images
(this time, <code>load_color_image</code> and <code>save_color_image</code>, respectively), as well
as some test images in the <code>test_images</code> directory (though, as before, you are
welcome to use images of your own as well!).</p>
<p>You should also copy over your functions from your work from last week's lab, as
some of the things we'll implement here will build on the filters from Lab 1
directly. <strong>Importantly, you should rename the lab 1 functions <code>load_image</code> and
<code>save_image</code> to <code>load_greyscale_image</code> and <code>save_greyscale_image</code>, respectively,
to avoid confusion with the <code>load_color_image</code> and <code>save_color_image</code> functions in
this lab.</strong> We will refer to <code>load_image</code> and <code>save_image</code> from Lab 1 as
<code>load_greyscale_image</code> and <code>save_greyscale_image</code> from here on out.</p>
<a class="anchor" name="catsoop_section_4"></a><a class="anchor" name="_filters_on_color_images"></a><h2 class="cs_section_title">4) Filters on Color Images<a class="cs_permalink" href="#_filters_on_color_images">§</a></h2>
<p>In last week's lab, we used Python function objects to represent filters: we
represented a filter as a function that took an image as input and
produced a related image as output.  We will continue this representation
this week: a filter for color images is a Python function that takes a color
image as its input and produces a related color image as its output.</p>
<p>While there are certainly other things we can do with color images, it turns
out that we can think about implementing color versions of many of the filters
from last week by separating our color image into three separate greyscale
images (one for each channel: red, green, and blue), applying the same
'greyscale' filter from last week to each one, and then recombining the results
together into a color image.</p>
<p>For example, we can think about a color version of our inversion filter as
working in the way illustrated in the diagram below:</p>
<center>
<img src="https://py.mit.edu/_static/fall20/labs/lab2/frog_process.png" style="max-width:100%"/>
</center>
<p>We can think about blurring or sharpening in similar ways: separate an image
into its three color components, apply a filter to each, and recombine them
together.</p>
<p>Given this common structure, it will be useful to have a common way to create
these kinds of color image filters from their greyscale counterparts.  As such,
your first task for this lab is to implement the
<code>color_filter_from_greyscale_filter</code> function in <code>lab.py</code>.  This function
should take as input <em>a Python function</em> representing a greyscale filter (i.e.,
a function that takes a greyscale image as input and produces a greyscale image
as its output).  Its return value should be a <em>new function</em> representing a color
image filter (i.e., a function that takes a color image as input and produces a
color image as its output).</p>
<p>This new filter should follow the pattern above: it should split the given
color image into its three components, apply the greyscale filter to each, and
recombine them into a new color image.</p>
<p>An example of its usage is given below:</p>
<pre><code class="language-py"># if we have a greyscale filter called inverted that inverts a greyscale
# image...
inverted_grey_frog = inverted(load_greyscale_image('grey_frog.png'))

# then the following will create a color version of that filter
color_inverted = color_filter_from_greyscale_filter(inverted)

# that can then be applied to color images to invert them (note that this
# should make a new color image, rather than mutating its input)
inverted_color_frog = color_inverted(load_color_image('color_frog.png'))
</code></pre>
<p>Implement the <code>color_filter_from_greyscale_filter</code> function in <code>lab.py</code>.  You
may find it helpful to define helper functions for splitting the color image
into three separate greyscale images (one for each color component) and for
recombining three greyscale images into a single new color image.</p>
<p><a class="anchor" name="catsoop_section_4_1"></a><a class="anchor" name="_check_your_results"></a><h3 class="cs_section_title">4.1) Check Your Results<a class="cs_permalink" href="#_check_your_results">§</a></h3></p>
<p>Use this function to create a color version of your inversion filter from lab 1
and apply it to the <code>cat.png</code> image from the <code>test_images</code> directory.  Save
your result as a color PNG image and upload your image below to be checked:</p>
<p>
<!--START question q000001 -->
<div class="question question-fileupload" id="cs_qdiv_q000001" style="position: static">
<div id="q000001_rendered_question">
Inverted <code>cat.png</code>:<br/><input id="q000001" name="q000001" style="display: none" type="file"/><button class="btn btn-catsoop" id="q000001_select_button">Select File</button> <tt><span id="q000001_selected_file">No file selected</span></tt><script type="text/javascript">
// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
document.getElementById('q000001_select_button').addEventListener('click', function (){
    document.getElementById("q000001").click();
});
document.getElementById('q000001').addEventListener('change', function (){
    document.getElementById('q000001_selected_file').innerText = document.getElementById('q000001').value;
});
// @license-end</script>
</div><div>
<span id="q000001_buttons"></span>
<span id="q000001_loading_wrapper">
<span id="q000001_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000001_score_display"></span>
<div class="nsubmits_left" id="q000001_nsubmits_left"></div></div>
<div id="q000001_solution_container">
<div id="q000001_solution">
</div>
<div id="q000001_solution_explanation">
</div>
</div>
<div id="q000001_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Friday September 18, 2020 at 04:00:00 PM Eastern time.</span></div>
<!--END question q000001 -->
</p>
<p><a class="anchor" name="catsoop_section_4_2"></a><a class="anchor" name="_other_kinds_of_filters"></a><h3 class="cs_section_title">4.2) Other Kinds of Filters<a class="cs_permalink" href="#_other_kinds_of_filters">§</a></h3></p>
<p>Note that the structure of the <code>color_filter_from_greyscale_filter</code> function
assumes a particular form for our greyscale filters: in particular, it expects
that the filters we pass to it as inputs are functions of <em>a single argument</em>.
However, some of our filters from last week did not follow this pattern.  In
particular, our <code>blurred</code> and <code>sharpened</code> filters took both an image and an
additional parameter.  So how can we implement these functions in such a way
that they can work together with <code>color_filter_from_greyscale_filter</code>?</p>
<p>One strategy is to define, for example, a function <code>make_blur_filter</code> that takes
the parameter <code>n</code> and returns a blur filter (which takes a single image as
argument).  In this way, we can make a blur filter that is consistent with the
form expected by <code>color_filter_from_greyscale_filter</code>, for example:</p>
<pre><code class="language-py"># last week, we could create a blurred greyscale image like follows:
blurry = blurred(load_greyscale_image('cat.png'), 3)

# we would like to make a function make_blur_filter that takes a single
# parameter and returns a filter.  the use of this function is illustrated
# below:
blur_filter = make_blur_filter(3)
blurry2 = blur_filter(load_greyscale_image('cat.png'))

# note that make_blur_filter(3), for example, produces a filter of the
# appropriate form for use with color_filter_from_greyscale_filter, but
# that blurry and blurry2 are equivalent images.

# it is also not necessary to store the output of make_blur_filter in a
# variable before calling it.  for example, the following also produces an
# equivalent image:
blurry3 = make_blur_filter(3)(load_greyscale_image('cat.png'))
</code></pre>
<p>Implement <code>make_blur_filter</code> and <code>make_sharpen_filter</code> in your <code>lab.py</code>.  Each
one of these functions should take a single argument <code>n</code> and should return a
function appropriate for use with <code>color_filter_from_greyscale_filter</code>.</p>
<p>For the sake of avoiding repetitious code, you should try to make use of
<code>blurred</code> and <code>sharpened</code> within your code, rather than reimplementing that
behavior.</p>
<p><a class="anchor" name="catsoop_section_4_3"></a><a class="anchor" name="_check_your_results_2"></a><h3 class="cs_section_title">4.3) Check Your Results<a class="cs_permalink" href="#_check_your_results_2">§</a></h3></p>
<p>Use these functions in conjunction with <code>color_filter_from_greyscale_filter</code>
to produce the images described below, and upload them to be checked:</p>
<p>
<!--START question q000002 -->
<div class="question question-fileupload" id="cs_qdiv_q000002" style="position: static">
<div id="q000002_rendered_question">
Blurred <code>python.png</code>, with <code>n=9</code>:<br/><input id="q000002" name="q000002" style="display: none" type="file"/><button class="btn btn-catsoop" id="q000002_select_button">Select File</button> <tt><span id="q000002_selected_file">No file selected</span></tt><script type="text/javascript">
// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
document.getElementById('q000002_select_button').addEventListener('click', function (){
    document.getElementById("q000002").click();
});
document.getElementById('q000002').addEventListener('change', function (){
    document.getElementById('q000002_selected_file').innerText = document.getElementById('q000002').value;
});
// @license-end</script>
</div><div>
<span id="q000002_buttons"></span>
<span id="q000002_loading_wrapper">
<span id="q000002_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000002_score_display"></span>
<div class="nsubmits_left" id="q000002_nsubmits_left"></div></div>
<div id="q000002_solution_container">
<div id="q000002_solution">
</div>
<div id="q000002_solution_explanation">
</div>
</div>
<div id="q000002_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Friday September 18, 2020 at 04:00:00 PM Eastern time.</span></div>
<!--END question q000002 -->
</p>
<p>
<!--START question q000003 -->
<div class="question question-fileupload" id="cs_qdiv_q000003" style="position: static">
<div id="q000003_rendered_question">
Sharpened <code>sparrowchick.png</code>, with <code>n=7</code>:<br/><input id="q000003" name="q000003" style="display: none" type="file"/><button class="btn btn-catsoop" id="q000003_select_button">Select File</button> <tt><span id="q000003_selected_file">No file selected</span></tt><script type="text/javascript">
// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
document.getElementById('q000003_select_button').addEventListener('click', function (){
    document.getElementById("q000003").click();
});
document.getElementById('q000003').addEventListener('change', function (){
    document.getElementById('q000003_selected_file').innerText = document.getElementById('q000003').value;
});
// @license-end</script>
</div><div>
<span id="q000003_buttons"></span>
<span id="q000003_loading_wrapper">
<span id="q000003_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000003_score_display"></span>
<div class="nsubmits_left" id="q000003_nsubmits_left"></div></div>
<div id="q000003_solution_container">
<div id="q000003_solution">
</div>
<div id="q000003_solution_explanation">
</div>
</div>
<div id="q000003_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Friday September 18, 2020 at 04:00:00 PM Eastern time.</span></div>
<!--END question q000003 -->
</p>
<a class="anchor" name="catsoop_section_5"></a><a class="anchor" name="_cascade_of_filters"></a><h2 class="cs_section_title">5) Cascade of Filters<a class="cs_permalink" href="#_cascade_of_filters">§</a></h2>
<p>Next, we'll add support for chaining filters together in cascade (so that the
output of one filter is used as the input to another, and so on).  You should
implement a function called <code>filter_cascade</code> in your lab file to this end.
This function should take a list of filters (Python functions) as input, and
its output should be a function that, when called on an input image, produces
the equivalent of applying each of the given filters, in turn, to the input image.</p>
<p>For example, if we have three filters <code>f1</code>, <code>f2</code>, and <code>f3</code>, then the following
two images should be equivalent:</p>
<pre><code class="language-py">out1 = f3(f2(f1(image)))

c = filter_cascade([f1, f2, f3])
out2 = c(image)
</code></pre>
<div class="question"><b>Check Yourself:</b><p>Does it matter if <code>filters</code> contains color or greyscale filters?
Can <code>filters</code> contain both color and greyscale filters?</p><p><span id="queue_checkyourself_1"></span></p></div>
<p>Implement the <code>filter_cascade</code> function in your <code>lab.py</code>.</p>
<p><a class="anchor" name="catsoop_section_5_1"></a><a class="anchor" name="_check_your_results_3"></a><h3 class="cs_section_title">5.1) Check Your Results<a class="cs_permalink" href="#_check_your_results_3">§</a></h3></p>
<p>When you are confident that your function is working as expected, apply the
following filter to <code>test_images/frog.png</code>, save the result as a PNG image,
and upload it below for checking:</p>
<pre><code class="language-py">filter1 = color_filter_from_greyscale_filter(edges)
filter2 = color_filter_from_greyscale_filter(make_blur_filter(5))
filt = filter_cascade([filter1, filter1, filter2, filter1])
</code></pre>
<p>
<!--START question q000004 -->
<div class="question question-fileupload" id="cs_qdiv_q000004" style="position: static">
<div id="q000004_rendered_question">
<code>frog.png</code> filtered by the filter given above:<br/><input id="q000004" name="q000004" style="display: none" type="file"/><button class="btn btn-catsoop" id="q000004_select_button">Select File</button> <tt><span id="q000004_selected_file">No file selected</span></tt><script type="text/javascript">
// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
document.getElementById('q000004_select_button').addEventListener('click', function (){
    document.getElementById("q000004").click();
});
document.getElementById('q000004').addEventListener('change', function (){
    document.getElementById('q000004_selected_file').innerText = document.getElementById('q000004').value;
});
// @license-end</script>
</div><div>
<span id="q000004_buttons"></span>
<span id="q000004_loading_wrapper">
<span id="q000004_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000004_score_display"></span>
<div class="nsubmits_left" id="q000004_nsubmits_left"></div></div>
<div id="q000004_solution_container">
<div id="q000004_solution">
</div>
<div id="q000004_solution_explanation">
</div>
</div>
<div id="q000004_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Friday September 18, 2020 at 04:00:00 PM Eastern time.</span></div>
<!--END question q000004 -->
</p>
<a class="anchor" name="catsoop_section_6"></a><a class="anchor" name="_seam_carving"></a><h2 class="cs_section_title">6) Seam Carving<a class="cs_permalink" href="#_seam_carving">§</a></h2>
<p><strong>You may wish to read all of the subsections in this part before implementing any code, so that you can make a more complete plan before diving in.</strong></p>
<p>Next, we'll implement a really neat kind of effect, often referred to as
"content-aware resizing" or "retargeting."  The goal of this technique is to
scale down an image while preserving the perceptually important parts (e.g.,
removing background but preserving subjects).</p>
<p>Two common approaches for resizing an image are <em>cropping</em> and <em>scaling</em>.
However, in certain situations, both of these methods can lead to undesirable
results.  The animation below shows these various kinds of resizing in action
on an image of two cats<a class="anchor" name="catsoop_footnote_ref_1"></a><a href="#catsoop_footnote_1"><sup>1</sup></a>, which is gradually scaled down from 300 pixels wide to 150
pixels wide.  Cropping is shown on the first row; naive scaling on the second
row; and a form of content-aware resizing called <em>seam carving</em> (which we'll
implement in this section) on the third row.</p>
<center>
<p><img alt="resizing_strategies" src="https://py.mit.edu/_static/fall20/labs/lab2/resize.gif"/></p>
</center>
<p>The first two strategies have shortcomings: cropping causes one of the cats to
be almost completely deleted, and scaling distorts both cats.  By focusing on
removing "low-energy" portions (defined below) of the image, however, the
seam-carving technique manages to keep both cats almost completely intact while
removing mostly background.</p>
<p>Here is another example, on a picture of several trees.  Notice again that the
trees are preserved almost exactly despite decreasing the width of the image by
75 pixels.</p>
<center>
<p><img alt="resizing_trees" src="https://py.mit.edu/_static/fall20/labs/lab2/resize2.gif"/></p>
</center>
<p><a class="anchor" name="catsoop_section_6_1"></a><a class="anchor" name="_outline_and_description_of_steps"></a><h3 class="cs_section_title">6.1) Outline and Description of Steps<a class="cs_permalink" href="#_outline_and_description_of_steps">§</a></h3></p>
<p>The images above were generated using a technique called <em>seam carving</em>, which
we'll implement in this section.  And, although the images above were the
result of applying seam carving to greyscale images, your code should work for
color images.</p>
<p>The idea behind seam carving is that, when we remove a pixel from each row to
decrease the size of an image, instead of removing a straight vertical line, we
instead find and remove connected 'paths' of pixels from the top to the bottom
of the image, with one pixel in each row. Each time we want to decrease the
horizontal size of the image by one pixel, we start by finding the connected
path from top to bottom that has the minimum total "energy," removing the
pixels contained therein.  To shrink the image further, we can apply this
process repeatedly.</p>
<p>We will define the 'energy' based on the edge-detection algorithm from earlier,
applied to a greyscale version of the image: the energy of any given pixel will
be the associated value in the output from edge detection, and the energy of a
path is the sum total of the energies of the pixels it contains.
The goal of finding and removing the minimum-energy path is accomplished by an algorithm
which is outlined below<a class="anchor" name="catsoop_footnote_ref_2"></a><a href="#catsoop_footnote_2"><sup>2</sup></a>.</p>
<p>The algorithm works by repeating the following five steps until the width of
the image reaches the desired size:</p>
<ol>
<li>
<p><strong>Make a greyscale copy</strong> of the current image, for using in computing the
energy map.  You can compute a color pixel's equivalent greyscale value <span class="cs_math_to_render">v</span> using the following formula, where <span class="cs_math_to_render">r</span>, <span class="cs_math_to_render">g</span>, and <span class="cs_math_to_render">b</span> represent the pixel's red, green, and blue values, respectively:</p>
<p><span class="cs_math_to_render">v = \text{round}\left(.299\times r + .587\times g + .114\times b\right)</span></p>
</li>
<li>
<p><strong>Compute energy map</strong>.  Because we are using our edge detector as our
'energy' function, this should simply involve calling the <code>edges</code> function on the
greyscale image.</p>
</li>
<li>
<p><strong>Compute a "cumulative energy map"</strong>, where the value at each position is
the total energy of the lowest-energy path from the top of the image to
that pixel.</p>
<p>For the top row, this will be equal to the top row from the energy map in step 2.
Subsequent rows can be computed using the following algorithm (in
pseudocode):</p>
<pre><code class="nohighlight"> For each row of the "cumulative energy map":
     For each pixel in the row:
         Set this value in the "cumulative energy map" to be:
           the value of that location in the energy map, added to the
           minimum of the cumulative energies from the "adjacent" pixels in the row
           above
</code></pre>
<p>For our purposes, we'll consider pixels in the row above to be "adjacent"
to the pixel we're considering if they are either directly above, or one pixel
to the right or to the left of, the pixel in question.  For example, the pixel
marked in blue below has three "adjacent" pixels in the row above
(indicated by the arrows), and the pixel marked in red (on the edge of the
image) has two "adjacent" pixels in the row above:</p>
<center>
<p><img alt="adjacent pixels" src="https://py.mit.edu/_static/fall20/labs/lab2/adjacent_pixels.png"/></p>
</center>
<p>(After completing this process, the value at each pixel in this
"cumulative energy map" will be the total energy of the lowest-energy path
from the top of the image to that location.)</p>
</li>
<li>
<p><strong>Find the minimum-energy seam.</strong>  The minimum seam can then be found by
backtracing from the bottom to the top of the cumulative energy map. First,
the minimum value pixel in the bottom row of the cumulative energy map is
located. This is the bottom pixel of the minimum seam. The seam is then
traced back up to the top row of the cumulative energy map by following the
adjacent pixels with the smallest cumulative energies.</p>
<p><strong>Ties should always be broken by preferring the left-most of the tied columns.</strong></p>
</li>
<li>
<p><strong>Remove the computed path.</strong>  Finally, we need to remove the pixels in the
computed seam from our original color image (and we should use this smaller result when we
start back at the top of these steps).  Note, though, that we would like for this
process to work without modifying the original image.</p>
</li>
</ol>
<p><a class="anchor" name="catsoop_section_6_1_1"></a><a class="anchor" name="_graphical_depiction"></a><h4 class="cs_section_title">6.1.1) Graphical Depiction<a class="cs_permalink" href="#_graphical_depiction">§</a></h4></p>
<p>The process described above (for removing one seam) is shown in the following
diagram:</p>
<center>
<img src="https://py.mit.edu/_static/fall20/labs/lab2/seam_carve_example.png" style="max-width:100%" width="400"/>
</center>
<p><a class="anchor" name="catsoop_section_6_2"></a><a class="anchor" name="_suggested_helper_functions_and_structure"></a><h3 class="cs_section_title">6.2) Suggested Helper Functions and Structure<a class="cs_permalink" href="#_suggested_helper_functions_and_structure">§</a></h3></p>
<p>This is a pretty complicated process, so it will be helpful to break it down
into smaller pieces.</p>
<p>While you are welcome to structure this code as you see fit, we have provided
skeletons for a number of helper functions in <code>lab.py</code>, which we think can be a
useful way to organize your code.  We strongly encourage you to fill these
functions in and use them to implement your overall seam-carving function, but
you are welcome to ignore these helper functions (or modify their structure) if
you wish; they will not be tested as part of your submission.</p>
<p>We have also provided test cases for these helper functions in the
<code>test_seam_carving_helpers.py</code> file (which you can make use of in the same
way as the normal <code>test.py</code>).  These tests will <em>not</em> be checked on the server
or included in your grade for Lab 2 (so you are welcome to comment them out or
delete them if you prefer to use a different structure for implementing seam
carving), but they can be helpful during debugging if you do choose to use the
structure outlined below.</p>
<p>The helper functions we recommend include:</p>
<ul>
<li><code>greyscale_image_from_color_image(image)</code>: given a color image, return a
greyscale image according to the formula above.</li>
<li><code>compute_energy(grey)</code>: given a greyscale image resulting from the step
above, compute the energy map (using your <code>edges</code> function from last
lab).</li>
<li><code>cumulative_energy_map(energy)</code>: given an energy map resulting from the above
step, return the "cumulative energy map" as described above.</li>
<li><code>minimum_energy_seam(cem)</code>: given a "cumulative energy map," return a list of the
indices into <code>im['pixels']</code> associated with the seam that should be removed</li>
<li><code>image_without_seam(image, seam)</code>: given an image and a list of indices, return
a new image with the associated pixels removed.</li>
</ul>
<p>The optional test cases in <code>test_seam_carving_helpers.py</code> assume that each of
these returns a structure like a greyscale image (a dictionary with <code>'height'</code>,
<code>'width'</code>, and <code>'pixels'</code> keys), but that these values are not necessarily
valid images (i.e., the values in the <code>'pixels'</code> array may be outside the <span class="cs_math_to_render">[0,
255]</span> range), except for <code>minimum_energy_seam</code>, which returns a list of
integers.</p>
<p><a class="anchor" name="catsoop_section_6_3"></a><a class="anchor" name="_example_with_intermediate_results"></a><h3 class="cs_section_title">6.3) Example with Intermediate Results<a class="cs_permalink" href="#_example_with_intermediate_results">§</a></h3></p>
<p>As you debug, it may also be helpful to have some concrete examples readily
available.  This section includes some intermediate results from removing one
seam from <code>pattern.png</code>.  While the exact structure of these results may be
different (if you choose not to use the helper functions described above), the
<em>values</em> contained in each should be the same regardless of your method.</p>
<p>Our greyscale copy of <code>pattern.png</code> should look like the following:</p>
<center>
<p><img alt="pattern_grey" src="https://py.mit.edu/_static/fall20/labs/lab2/pattern_greyscale_big.png"/></p>
</center>
<pre><code class="language-python">{'height': 4, 'width': 9, 'pixels': [200, 160, 160, 160, 153, 160, 160, 160, 200, 200, 160, 160, 160, 153, 160, 160, 160, 200, 0, 153, 160, 160, 160, 160, 160, 153, 0, 0, 153, 153, 160, 160, 160, 153, 153, 0]}
</code></pre>
<p>Computing the energy map produces:</p>
<center>
<p><img alt="pattern_energy" src="https://py.mit.edu/_static/fall20/labs/lab2/pattern_energy_big.png"/></p>
</center>
<pre><code class="language-python">{'width': 9, 'height': 4, 'pixels': [160, 160, 0, 28, 0, 28, 0, 160, 160, 255, 218, 10, 22, 14, 22, 10, 218, 255, 255, 255, 30, 0, 14, 0, 30, 255, 255, 255, 255, 31, 22, 0, 22, 31, 255, 255]}
</code></pre>
<p>Using this to compute the cumulative energy map yields the following (which
looks very similar for this particular image but is actually different):</p>
<center>
<p><img alt="pattern_cumulative" src="https://py.mit.edu/_static/fall20/labs/lab2/pattern_cumulative_big.png"/></p>
</center>
<pre><code class="language-python">{'width': 9, 'height': 4, 'pixels': [160, 160, 0, 28, 0, 28, 0, 160, 160, 415, 218, 10, 22, 14, 22, 10, 218, 415, 473, 265, 40, 10, 28, 10, 40, 265, 473, 520, 295, 41, 32, 10, 32, 41, 295, 520]}
</code></pre>
<p>From which we find the minimum energy seam contains the values indicated in red below:</p>
<center>
<p><img alt="pattern_seam" src="https://py.mit.edu/_static/fall20/labs/lab2/pattern_seam_big.png"/></p>
</center>
<p>Represented by the following list of indices (in any order)</p>
<pre><code class="language-python">[2, 11, 21, 31]
</code></pre>
<p>After removing the seam, the resulting image should look like
<code>test_results/pattern_1seam.png</code>:</p>
<center>
<p><img alt="pattern_carved" src="https://py.mit.edu/_static/fall20/labs/lab2/pattern_carved_big.png"/></p>
</center>
<p><a class="anchor" name="catsoop_section_6_4"></a><a class="anchor" name="_write_it"></a><h3 class="cs_section_title">6.4) Write It!<a class="cs_permalink" href="#_write_it">§</a></h3></p>
<p>Fill in the body of the <code>seam_carving</code> function in your <code>lab.py</code> so that it
implements seam carving using the method described above.  Note that both the
input and output should be <em>color</em> images, and note that the <code>seam_carving</code>
function should not modify the image that it is given as input.</p>
<p><a class="anchor" name="catsoop_section_6_5"></a><a class="anchor" name="_check_your_results_4"></a><h3 class="cs_section_title">6.5) Check Your Results<a class="cs_permalink" href="#_check_your_results_4">§</a></h3></p>
<p>When you are confident that things are working as expected, try running your
code on <code>twocats.png</code>, removing 100 seams from it (reducing the width by 100).
Save your results (in color) and upload the resulting files below for testing.
Note that this may take a <strong>long</strong> time to run (multiple minutes on most
machines)!  You may wish to add some print statements (for example, printing
how many columns have been removed every time a new column is removed) to help
keep track of your program's progress.</p>
<p>
<!--START question q000005 -->
<div class="question question-fileupload" id="cs_qdiv_q000005" style="position: static">
<div id="q000005_rendered_question">
Seam Carved <code>twocats.png</code>:<br/><input id="q000005" name="q000005" style="display: none" type="file"/><button class="btn btn-catsoop" id="q000005_select_button">Select File</button> <tt><span id="q000005_selected_file">No file selected</span></tt><script type="text/javascript">
// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
document.getElementById('q000005_select_button').addEventListener('click', function (){
    document.getElementById("q000005").click();
});
document.getElementById('q000005').addEventListener('change', function (){
    document.getElementById('q000005_selected_file').innerText = document.getElementById('q000005').value;
});
// @license-end</script>
</div><div>
<span id="q000005_buttons"></span>
<span id="q000005_loading_wrapper">
<span id="q000005_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000005_score_display"></span>
<div class="nsubmits_left" id="q000005_nsubmits_left"></div></div>
<div id="q000005_solution_container">
<div id="q000005_solution">
</div>
<div id="q000005_solution_explanation">
</div>
</div>
<div id="q000005_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Friday September 18, 2020 at 04:00:00 PM Eastern time.</span></div>
<!--END question q000005 -->
</p>
<a class="anchor" name="catsoop_section_7"></a><a class="anchor" name="_something_of_your_own"></a><h2 class="cs_section_title">7) Something of Your Own<a class="cs_permalink" href="#_something_of_your_own">§</a></h2>
<p>Finally, we would like for you to implement something new of your own choosing!
There are no test cases for this portion of the lab, which means that you will
not lose points if you complete it any time before your checkoff (even after
the code submission deadline). You are, however, expected to include your
creative addition in the code submission by the time of your checkoff, so that
it can be discussed during checkoff.</p>
<p>You are welcome to implement whatever you like here, and, unlike other portions
of the lab, you are welcome to import the <code>math</code> or <code>random</code> modules in this
section.  If you want to use other modules, that might be ok, but please ask us
first!</p>
<p>We encourage you to implement things that sound interesting to you!  If you are
having trouble thinking of what to do, here are some ideas that might help you
get started, and we're certainly happy to answer questions as you work through
things:</p>
<ul>
<li>
<p>You could implement some drawing primitives so that you can draw shapes on top of images.  Maybe <code>circle(image, (r, g, b), x, y, radius)</code> draws a circle of the given size at the given location.  You could implement multiple drawing primitives and use them to draw a nice new picture (or to modify an existing one!).</p>
</li>
<li>
<p>You could implement a "threshold" filter where, on each channel, values above a certain threshold are replaced with 255 and values below that threshold are replaced with 0.  You could implement this in such a way that <code>threshold</code> is a function that takes a threshold value, and returns a color filter (perhaps created using <code>color_filter_from_greyscale_filter</code> from a greyscale version of this filter).</p>
</li>
<li>
<p>You could implement some other new filters such as amplifying a certain color or a <a href="https://en.wikipedia.org/wiki/Image_embossing">directional emboss</a>. You could even combine them with some of the others using <code>filter_cascade</code> to make a new effect.</p>
</li>
<li>
<p>You could add the equivalent of "pasting" smaller images on top of larger ones (maybe also including a color that should be treated as transparent for purposes of the copy/paste, so that pixels of that color in the pasted image are not copied over).</p>
</li>
<li>
<p>You could implement a different kind of filter that takes spatial information
into account, in addition to color information, such as a <a href="https://en.wikipedia.org/wiki/Vignetting">vignette</a> or a <a href="https://docs.gimp.org/2.8/en/plug-in-ripple.html">ripple filter</a>.</p>
</li>
<li>
<p>You could implement the equivalent of <a href="https://www.gimp.org/tutorials/Basic_Color_Curves/">color curves</a>, for example by implementing something like described in <a href="http://www.practicepython.org/blog/2016/12/20/instagram-filters-python.html">this article</a>.  Or, you could play around with the color content of images in other ways.</p>
</li>
<li>
<p>You could implement the opposite of seam carving: smart resizing to <em>increase</em> the size of an image by inserting appropriate rows at low-energy regions in the image.</p>
</li>
</ul>
<p>Regardless of what you choose to implement here, you should be prepared to discuss
your code and demonstrate your results during your checkoff conversation.</p>
<a class="anchor" name="catsoop_section_8"></a><a class="anchor" name="_code_submission"></a><h2 class="cs_section_title">8) Code Submission<a class="cs_permalink" href="#_code_submission">§</a></h2>
<p>When you have tested your code sufficiently on your own machine, submit
your modified <code>lab.py</code> by clicking on "Choose File," then
clicking the <code>Submit</code> button to send the file to the 6.009 server.  The server will
run the tests and report back the results below.</p>
<p>Because of this time delay, it is a good idea to implement some tests on your
own machine so that you can locally verify that these behaviors are working
correctly.</p>
<p>
<!--START question q000006 -->
<div class="question question-lab009" id="cs_qdiv_q000006" style="position: static">
<div id="q000006_rendered_question">
<input id="q000006" name="q000006" style="display: none" type="file"/><button class="btn btn-catsoop" id="q000006_select_button">Select File</button> <tt><span id="q000006_selected_file">No file selected</span></tt>
<script type="text/javascript">
document.getElementById('q000006').value = '';
document.getElementById('q000006_select_button').addEventListener('click', function (){
    document.getElementById("q000006").click();
});
document.getElementById('q000006').addEventListener('change', function (){
    document.getElementById('q000006_selected_file').innerText = document.getElementById('q000006').value;
});
</script>
</div><div>
<span id="q000006_buttons"></span>
<span id="q000006_loading_wrapper">
<span id="q000006_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000006_score_display"></span>
<div class="nsubmits_left" id="q000006_nsubmits_left"></div></div>
<div id="q000006_solution_container">
<div id="q000006_solution">
</div>
<div id="q000006_solution_explanation">
</div>
</div>
<div id="q000006_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Friday September 18, 2020 at 04:00:00 PM Eastern time.</span></div>
<!--END question q000006 -->
</p>
<a class="anchor" name="catsoop_section_9"></a><a class="anchor" name="_checkoff"></a><h2 class="cs_section_title">9) Checkoff<a class="cs_permalink" href="#_checkoff">§</a></h2>
<p>Once you are finished with the code, you will need to come to an office hour
and add yourself to the queue asking for a checkoff in
order to receive credit for the lab.  <strong>You must be ready to discuss your code
and test cases in detail before asking for a checkoff.</strong></p>
<p>You should be prepared to demonstrate your code (which should be
well-commented, should avoid repetition, and should make good use of helper
functions).  In particular, be prepared to discuss:</p>
<ul>
<li>Your implementation of <code>color_filter_from_greyscale_filter</code>.</li>
<li>Your implementation of <code>make_blur_filter</code>.</li>
<li>Your implementation of <code>filter_cascade</code>.</li>
<li>Your implementation of the seam-carving.</li>
<li>Your creative extension.</li>
</ul>
<p><a class="anchor" name="catsoop_section_9_1"></a><a class="anchor" name="_grade"></a><h3 class="cs_section_title">9.1) Grade<a class="cs_permalink" href="#_grade">§</a></h3></p>
<div class="response"><i>You have not yet received this checkoff.  When you have completed this checkoff, you will see a grade here.</i></div>
<script src="https://py.mit.edu/_static/_handler/default/cs_ajax.js" type="text/javascript"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
catsoop.all_questions = ['pre_lecture', 'q000001', 'q000002', 'q000003', 'q000004', 'q000005', 'q000006'];
catsoop.username = null;
catsoop.api_token = null;
catsoop.this_path = 'https://py.mit.edu/fall20/labs/lab2';
catsoop.path_info = ['fall20', 'labs', 'lab2'];
catsoop.course = 'fall20';
catsoop.url_root = 'https://py.mit.edu';
catsoop.imp = '';
catsoop.skip_alert = [];
catsoop.viewans_confirm = "Are you sure?  Viewing the answer will prevent any further submissions to this question.  Press 'OK' to view the answer, or press 'Cancel' if you have changed your mind.";

// @license-end</script>
<br/> <hr/><b name="cs_footnotes">Footnotes</b><p><a class="anchor" name="catsoop_footnote_1"></a><sup style="padding-right:0.25em;color:var(--cs-base-bg-color);">1</sup>This animation is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY SA 4.0 International
License</a>.  The original image
of two cats, which is licensed under a <a href="https://creativecommons.org/licenses/by/2.0/">CC BY 2.0
License</a>, comes from
<a href="https://www.flickr.com/photos/95962563@N02/26830567365/">wellflat</a> on
Flickr. <a href="#catsoop_footnote_ref_1"><span class="noprint">(click to return to text)</span></a></p><p><a class="anchor" name="catsoop_footnote_2"></a><sup style="padding-right:0.25em;color:var(--cs-base-bg-color);">2</sup>For more information, see the <a href="https://en.wikipedia.org/wiki/Seam_carving">Wikipedia page for seam carving</a>. <a href="#catsoop_footnote_ref_2"><span class="noprint">(click to return to text)</span></a></p>
</div>
</div>
<div class="cs_right_menu"></div>
</main>
<footer>
<div class="cs_navigation cs_bottom_navigation" id="cs_bottom_navigation"><span class="line"><a href="https://py.mit.edu/fall20">Home</a></span> <span class="cs_nav_separator">/</span> <span class="line"><a href="https://py.mit.edu/fall20/labs/lab2">Lab 2: Image Processing, Part 2</a></span></div>
<div class="cs_footer">
      This page was last updated on Tuesday September 15, 2020 at 01:40:47 PM (revision <code>ba2774c8</code>).<br/> <br/>
<pre class="catsooplogo" style="font-size:50%;">\            
/    /\__/\  
\__=(  o_O )=
(__________) 
 |_ |_ |_ |_ </pre>
      Powered by <a href="https://catsoop.mit.edu" target="_blank">CAT-SOOP</a> v2021.2.0.dev1971+hg ("Devon Rex" development snapshot).<br/>
      CAT-SOOP is <a href="https://www.fsf.org/about/what-is-free-software" target="_blank">Free/Libre Software</a>, available under the terms<br/>of the <a href="https://py.mit.edu/_util/license" target="_blank">GNU Affero General Public License, version 3</a>.<br/>
<a download="" href="https://py.mit.edu/_util/source.zip" target="_blank">Download Source Code</a><br/>
<a href="https://py.mit.edu/_util/jslicense.html" rel="jslicense" target="_blank">Javascript License Information</a>
</div>
</footer>
</body>
</html>

