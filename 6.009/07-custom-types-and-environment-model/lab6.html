<!DOCTYPE html>

<html>
<head>
<!-- This page was generated by CAT-SOOP 2021.2.0.dev1971+hg.  miau. -->
<meta charset="utf-8"/>
<title>Lab 6: SAT Solver | 6.009 Fall 2020</title>
<link href="https://py.mit.edu/_static/fall20/logo.gif" rel="icon" type="image/gif"/>
<!-- include catsoop base css -->
<link href="https://py.mit.edu/_static/_base/themes/base.css" rel="stylesheet" type="text/css"/>
<!-- set up JS namespace for catsoop -->
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    var catsoop = {plugins: {}};

    function toggleResponsiveHeader(){
        document.getElementsByTagName('header')[0].classList.toggle('responsive');
    }

    window.addEventListener('DOMContentLoaded', function(){
        var menu_boxes = document.getElementsByClassName('dropdown-checkbox');
        for(var i=0; i<menu_boxes.length; i++){
            menu_boxes[i].checked = false;
        }
    });

    function clearMenu(menu){
       menu.children[1].checked = false;
    }
    // @license-end
    </script>
<!-- load in katex and CAT-SOOP-specific math rendering  -->
<script src="https://py.mit.edu/_static/_base/scripts/katex/katex.min.js" type="text/javascript"></script>
<link href="https://py.mit.edu/_static/_base/scripts/katex/katex.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    catsoop.katex_macros = {};
    catsoop.render_math = function (elt) {
        var tex = elt.innerText; // TeX Source
        var display = elt.classList.contains('cs_displaymath');
        try {
            katex.render(tex, elt, {displayMode: display, macros: catsoop.katex_macros});
        }catch(e) {
            console.log(e);
            elt.innerHTML = "<font color='red'><b>Could not parse math:</b> <tt>" + tex + "</tt></font>";
        }
        elt.classList.remove('cs_math_to_render');
    }


    catsoop.render_all_math = function (elt){
        var mathelts = elt.getElementsByClassName('cs_math_to_render');
        while(mathelts.length > 0){
            catsoop.render_math(mathelts[0]);
        }
    }
    document.addEventListener("DOMContentLoaded", function(event) {
          catsoop.render_all_math(document);
    });
    // @license-end
    </script>
<!-- load in diagram stuff -->
<script src="https://py.mit.edu/_static/_base/scripts/cs_diagrams.js" type="text/javascript"></script>
<script type="text/javascript">
        catsoop.diagram_sources = {};
    </script>
<!-- Syntax Highlighting -->
<script src="https://py.mit.edu/_static/_base/scripts/highlight/highlight.min.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/highlightjs-line-numbers.js" type="text/javascript"></script>
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    hljs.initHighlightingOnLoad();
    window.addEventListener('DOMContentLoaded', function(){
        document.querySelectorAll('.hl code').forEach((block) => {
            hljs.highlightBlock(block);
        });
        document.querySelectorAll('code.highlight-lines').forEach(function(b){
            hljs.lineNumbersBlock(b);
            if ((b.innerHTML.trim().match(/\r\n|\r|\n/g) || []).length > 0){
                b.parentElement.style = "padding-left: 0px !important;"
                b.classList.add('hljs');
            }
        });
    });
    // @license-end
    </script>
<style>
      :root {
        --cs-base-bg-color: #039bba;
        --cs-light-bg-color: #62d5ed;
        --cs-base-font-color: #fff;
        --cs-light-font-color: #000;
    }
    </style>
<style>
.cs_top_menu_item {
  font-size: 0.88rem;
}
div.dropdown {
  -moz-transform: translateY(-1px);
}
</style>
<!-- CodeMirror -->
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/codemirror.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/mode/python/python.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/addon/fold/foldcode.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/addon/fold/foldgutter.js" type="text/javascript"></script>
<script src="https://py.mit.edu/_static/_base/scripts/codemirror/addon/fold/indent-fold.js" type="text/javascript"></script>
<link href="https://py.mit.edu/_static/_base/scripts/codemirror/codemirror.css" rel="stylesheet"/>
<link href="https://py.mit.edu/_static/_base/scripts/codemirror/addon/fold/foldgutter.css" rel="stylesheet"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
</head>
<body style="margin: 0px;">
<header id="cs_header">
<div class="nav-container">
<div class="cs_header_text"><a href="https://py.mit.edu/fall20"><img src="https://py.mit.edu/_static/fall20/logo.gif"/> 6.009</a></div>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/information">Information/Policies</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/progress">Progress</a>
<div class="dropdown" onmouseleave="clearMenu(this);">
<label class="dropbtn cs_top_menu_item" for="cs_menu_e92315598caf37074f1c2542f0bc9c06">Help<span class="downarrow">▼</span></label>
<input checked="false" class="dropdown-checkbox" id="cs_menu_e92315598caf37074f1c2542f0bc9c06" type="checkbox"/>
<div class="dropdown-content">
<a class="cs_top_menu_item" href="https://py.mit.edu/forum">Forum</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/queue/">Help Queue</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/python">Accessing/Installing Python</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/notes">Course Notes</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/otherhelp">Other Help</a></div></div>
<a class="cs_top_menu_item" href="https://py.mit.edu/fall20/labs/lab6?loginaction=login">Log In</a><a class="icon" href="javascript:void(0);" onclick="toggleResponsiveHeader()">☰</a>
</div>
</header>
<div class="cs_navigation cs_top_navigation" id="cs_top_navigation"><span class="line"><a href="https://py.mit.edu/fall20">Home</a></span> <span class="cs_nav_separator">/</span> <span class="line"><a href="https://py.mit.edu/fall20/labs/lab6">Lab 6: SAT Solver</a></span></div>
<main class="cs_body" id="cs_body">
<div class="cs_left_menu"></div>
<div class="cs_content">
<div class="cs_page_body">
<center><h1 class="cs_content_header">Lab 6: SAT Solver</h1></center>
<center>The questions below are due on Friday October 23, 2020; 04:00:00 PM.<br/> <br/></center><div class="response" id="catsoop_login_box">
<b><center>You are not logged in.</center></b><br/>
If you are a current student, please <a href="https://py.mit.edu/fall20/labs/lab6?loginaction=login">Log
In</a> for full access to the web site.<br/>Note that this link will take you to
an external site (<tt>https://shimmer.mit.edu</tt>) to authenticate, and then you will be redirected
back to this page.
</div>
<h2>Table of Contents</h2><ul><li><a href="#_preparation">1) Preparation</a></li><li><a href="#_introduction">2) Introduction</a></li><ul><li><a href="#_conjunctive_normal_form">2.1) Conjunctive Normal Form</a></li><ul><li><a href="#_python_representation">2.1.1) Python Representation</a></li><li><a href="#_examples">2.1.2) Examples</a></li></ul></ul><li><a href="#_sat_solver">3) SAT Solver</a></li><ul><li><a href="#_the_naive_approach">3.1) The Naive Approach</a></li><li><a href="#_a_nicer_approach">3.2) A Nicer Approach</a></li><ul><li><a href="#_updating_expressions">3.2.1) Updating Expressions</a></li><li><a href="#_examples_2">3.2.2) Examples</a></li></ul></ul><li><a href="#_implementation">4) Implementation</a></li><ul><li><a href="#_optimizations">4.1) Optimizations</a></li></ul><li><a href="#_scheduling_by_reduction">5) Scheduling by Reduction</a></li><ul><li><a href="#_encoding_the_rules">5.1) Encoding the Rules</a></li><ul><li><a href="#_students_only_in_desired_sessions">5.1.1) Students Only In Desired Sessions</a></li><li><a href="#_each_student_in_exactly_one_session">5.1.2) Each Student In Exactly One Session</a></li><li><a href="#_no_oversubscribed_sessions">5.1.3) No Oversubscribed Sessions</a></li></ul></ul><li><a href="#_ui">6) UI</a></li><li><a href="#_code_submission">7) Code Submission</a></li><li><a href="#_checkoff">8) Checkoff</a></li><ul><li><a href="#_grade">8.1) Grade</a></li></ul></ul>
<a class="anchor" name="catsoop_section_1"></a><a class="anchor" name="_preparation"></a><h2 class="cs_section_title">1) Preparation<a class="cs_permalink" href="#_preparation">§</a></h2>
<p>This lab assumes you have Python 3.6 or later installed on your machine.</p>
<p>The following file contains code and other resources as a starting point for
this lab: <a download="lab6.zip" href="https://py.mit.edu/fall20/lab_distribution.zip?path=%5B%22fall20%22%2C+%22labs%22%2C+%22lab6%22%5D"><tt>lab6.zip</tt></a></p>
<p>Most of your changes should be made to <code>lab.py</code>, which you will submit at the
end of this lab.  Importantly, you should not add any imports to the file.</p>
<p>You can also see and participate in online discussion about this lab in the <a href="https://py.mit.edu/forum/c/labs/lab-6" target="_blank">"Lab 6"
Category</a> in the forum.</p>
<p>This lab is worth a total of 4 points.  Your score for the lab is based on:</p>
<ul>
<li>answering the questions on this page (0.5 points)</li>
<li>passing the test cases from <code>test.py</code> under the time limit (2 points), and</li>
<li>a brief "checkoff" conversation with a staff member to discuss your code (1.5 points).</li>
</ul>
<p>Note that passing all of the tests on the server will require that your code runs reasonably efficiently.</p>
<p>Please also review the <a href="https://py.mit.edu/fall20/information#catsoop_section_6">collaboration policy</a> before continuing.</p>
<p><strong>The questions in sections 1-3 (inclusive) are due before lecture, at 11:00am Eastern on Monday, 19 October.
The other questions on this page (including your code submission) are due at
4pm Eastern on Friday, 23 October.  The checkoff is due at 10pm Eastern on Wednesday, 28 October.</strong></p>
<a class="anchor" name="catsoop_section_2"></a><a class="anchor" name="_introduction"></a><h2 class="cs_section_title">2) Introduction<a class="cs_permalink" href="#_introduction">§</a></h2>
<p>From recreational mathematics to standardized tests, one popular problem genre
is <i>logic puzzles</i>, where some space of possible choices is described
using a list of rules.  A solution to the puzzle is a choice (often the one
unique choice) that obeys the rules.  This lab should give you the tools to
make short work of any of those puzzles, assuming you have your trusty Python
interpreter.</p>
<p>Here's an example of the kind of logic puzzle we have in mind.</p>
<div class="question">
The 6.009 staff were pleased to learn that grateful alumni had donated cupcakes for last week's staff meeting.
Unfortunately, the cupcakes were gone when the staff showed up for the meeting!
Who ate the cupcakes?
<ol>
<li>The suspects are Saman, Adam H, Armando, Adam C, and Tim the Beaver.</li>
<li>Whichever suspect ate any of the cupcakes must have eaten <i>all</i> of them.</li>
<li>The cupcakes included exactly two of the flavors chocolate, vanilla, and pickles.</li>
<li>Saman only eats pickles-flavored cupcakes.</li>
<li>Years ago, Armando and Adam C made a pact that, whenever either of them eats cupcakes, they must share with the other one.</li>
<li>Adam H feels strongly about flavor fairness and will only eat cupcakes if he can include at least 3 different flavors.</li>
</ol>
</div>
<p>Let's translate the problem into <b><a href="https://en.wikipedia.org/wiki/Boolean_algebra">Boolean logic</a></b>,
where we have a set of variables, each of which takes the value <code>True</code> or <code>False</code>.
We write the rules as conditions over these variables.  Here is each rule as a
Python expression over Boolean variables.  We include one variable for the
guilt of each suspect, plus one variable for each potential flavor of cupcake.</p>
<p>In reading these rules, note that Python <code>not</code> binds more tightly than <code>or</code>, so
that <code>not p or q</code> is the same as <code>(not p) or q</code>.  It's also fine not to follow
every last detail, as this rule set is just presented as one example of a
general idea!</p>
<p>You may also find that some of our encoding choices don't match what you would
come up with, such that our choices lead to longer or less-comprehensible
rules.  We are actually intentionally forcing ourselves to adhere to a
restricted format that we will explain shortly, and that will ultimately make
the job of <em>solving</em> these kinds of problems more straightforward.</p>
<pre><code class="language-python">rule1 = (saman or adam_h or armando or adam_c or tim)
# At least one of them must have committed the crime!  Here, one of these
# variables being True represents that person having committed the crime.


rule2 = ((not saman or not adam_h)
     and (not saman or not armando)
     and (not saman or not adam_c)
     and (not saman or not tim)
     and (not adam_h or not armando)
     and (not adam_h or not adam_c)
     and (not adam_h or not tim)
     and (not armando or not adam_c)
     and (not armando or not tim)
     and (not adam_c or not tim))
# At most one of the suspects is guilty.  In other words, for any pair of
# suspects, at least one must be NOT guilty (so that we cannot possibly find
# two or more people guilty).
# Together, rule2 and rule1 guarantee that exactly one suspect is guilty.


rule3 = ((not chocolate or not vanilla or not pickles)
     and (chocolate or vanilla)
     and (chocolate or pickles)
     and (vanilla or pickles))
# Here is our rule that the cupcakes included exactly two of the flavors.  Put
# another way: it can't be that all flavors were present, and among any pair of
# flavors, at least one was present.


rule4 = ((not saman or pickles)
     and (not saman or not chocolate)
     and (not saman or not vanilla))
# If Saman is guilty, this will evaluate to True only if only pickles-flavored
# cupcakes were present.  If Saman is not guilty, this will always evaluate to
# True.  This is our way of encoding the fact that, if Saman is guilty, only
# pickles-flavored cupcakes must have been present.


rule5 = (not armando or adam_c) and (not adam_c or armando)
# If Armando ate cupcakes without sharing with Adam C, the first case will fail to
# hold.  Likewise for Adam C eating without sharing.  Since Armando and Adam C only
# eat cupcakes together, this rule excludes the possibility that only one of
# them ate cupcakes.


rule6 = ((not adam_h or chocolate)
     and (not adam_h or vanilla)
     and (not adam_h or pickles))
# If Adam H is the culprit and we left out a flavor, the corresponding case here
# will fail to hold.  So this rule encodes the restriction that Adam H can only
# be guilty if all three types of cupcakes are present.


satisfied = rule1 and rule2 and rule3 and rule4 and rule5 and rule6
</code></pre>
<p>The piece of code above is a Python program that will tell us whether a given
assignment is consistent with the rules we have laid out.  For example, if we
had set the following variables (representing the hypothesis that Saman was guilty
and that only Pickles-flavored cupcakes were present):</p>
<pre><code class="language-py">saman = True
adam_h = False
armando = False
adam_c = False
tim = False

pickles = True
vanilla = False
chocolate = False
</code></pre>
<p>and then run the code, the <code>satisfied</code> variable would be set to <code>False</code> (since
<code>rule3</code> would be <code>False</code>), indicating that this assignment did not satisfy the
rules we had set out.</p>
<p>While code like the above could be useful in certain situations, it doesn't
help us <em>solve</em> the problem (it only helps us check a possible solution).  In this lab,
we'll look at the problem of <a href="https://en.wikipedia.org/wiki/Boolean_satisfiability_problem">Boolean
Satisfiability</a>: our goal will be, given a description of Boolean variables
and constraints on them (like that given above), to find a set of assignments
that satisfies all of the given constraints.</p>
<p><a class="anchor" name="catsoop_section_2_1"></a><a class="anchor" name="_conjunctive_normal_form"></a><h3 class="cs_section_title">2.1) Conjunctive Normal Form<a class="cs_permalink" href="#_conjunctive_normal_form">§</a></h3></p>
<p>In encoding the puzzle, we followed a very regular structure in our Boolean
formulas, one important enough to have a common name: <b><a href="https://en.wikipedia.org/wiki/Conjunctive_normal_form">conjunctive normal
form (CNF)</a></b>.</p>
<p>In this form, we say that a <i>literal</i> is a variable or the <code>not</code> of a variable.
Then a <i>clause</i> is a multi-way <code>or</code> of literals, and a CNF <em>formula</em> is a multi-way <code>and</code> of clauses.</p>
<p>It's okay if this representation does not feel completely natural.  Some people
find this form to be "backwards" from the way they would otherwise think about
these constraints.  However, forcing our constraints to be in this form can greatly
simplify our problem.  We'll try in this writeup to help you with the pieces of
the lab involving converting expressions to CNF.</p>
<p><a class="anchor" name="catsoop_section_2_1_1"></a><a class="anchor" name="_python_representation"></a><h4 class="cs_section_title">2.1.1) Python Representation<a class="cs_permalink" href="#_python_representation">§</a></h4></p>
<p>When we commit to representing problems in CNF, we can represent:</p>
<ul>
<li>a <em>variable</em> as a Python string</li>
<li>a <em>literal</em> as a pair (a tuple), containing a variable and a Boolean value (<code>False</code> if <code>not</code> appears in this literal, <code>True</code> otherwise)</li>
<li>a <em>clause</em> as a list of literals</li>
<li>a <em>formula</em> as a list of clauses</li>
</ul>
<p>For example, our puzzle from above can be encoded as follows, where again it is
OK not to read through every last detail.</p>
<pre><code class="language-python">rule1 = [[('saman', True), ('adam_h', True), ('armando', True),
          ('adam_c', True), ('tim', True)]]

rule2 = [[('saman', False), ('adam_h', False)],
         [('saman', False), ('armando', False)],
         [('saman', False), ('adam_c', False)],
         [('saman', False), ('tim', False)],
         [('adam_h', False), ('armando', False)],
         [('adam_h', False), ('adam_c', False)],
         [('adam_h', False), ('tim', False)],
         [('armando', False), ('adam_c', False)],
         [('armando', False), ('tim', False)],
         [('adam_c', False), ('tim', False)]]


rule3 = [[('chocolate', False), ('vanilla', False), ('pickles', False)],
         [('chocolate', True), ('vanilla', True)],
         [('chocolate', True), ('pickles', True)],
         [('vanilla', True), ('pickles', True)]]

rule4 = [[('saman', False), ('pickles', True)],
         [('saman', False), ('chocolate', False)],
         [('saman', False), ('vanilla', False)]]

rule5 = [[('armando', False), ('adam_c', True)],
         [('adam_c', False), ('armando', True)]]

rule6 = [[('adam_h', False), ('chocolate', True)],
         [('adam_h', False), ('vanilla', True)],
         [('adam_h', False), ('pickles', True)]]

rules = rule1 + rule2 + rule3 + rule4 + rule5 + rule6
</code></pre>
<p>When we have formulated things in this way, the list <code>rules</code> contains a formula
that encodes all of the constraints we need to satisfy.</p>
<p><a class="anchor" name="catsoop_section_2_1_2"></a><a class="anchor" name="_examples"></a><h4 class="cs_section_title">2.1.2) Examples<a class="cs_permalink" href="#_examples">§</a></h4></p>
<p>
<!--START question q000000 -->
<div class="question question-pythonliteral" id="cs_qdiv_q000000" style="position: static">
<div id="q000000_rendered_question">
Consider this Boolean formula.
<pre><code class="language-python">c and (a or d) and (not b or a) and (not a or e or not d)
</code></pre>
<p>Write an equivalent CNF formula (as a Python literal), in the format used in the lab (e.g., <code>[[('a', True), ('b', False)], [('c', True)]]</code>).<br/></p><input id="q000000" name="q000000" size="70" type="text" value=""/>
</div><div>
<span id="q000000_buttons"></span>
<span id="q000000_loading_wrapper">
<span id="q000000_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000000_score_display"></span>
<div class="nsubmits_left" id="q000000_nsubmits_left"></div></div>
<div id="q000000_solution_container">
<div id="q000000_solution">
</div>
<div id="q000000_solution_explanation">
</div>
</div>
<div id="q000000_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Monday October 19, 2020 at 11:00:00 AM Eastern time.</span></div>
<!--END question q000000 -->
</p>
<p>Now, consider this Boolean formula (which is <strong>not</strong> in CNF).</p>
<pre><code class="language-python">(a and b) or (c and not d)
</code></pre>
<p>This expression looks innocuous, but translating it into CNF is actually a
nontrivial exercise!  It turns out, though, that this expression does have a
representation in CNF as:</p>
<pre><code class="language-python">(a or c) and (a or not d) and (b or c) and (b or not d)
</code></pre>
<p>or, in our representation, as:</p>
<pre><code class="language-python">[[('a', True), ('c', True)], [('a', True), ('d', False)], [('b', True), ('c', True)], [('b', True), ('d', False)]]
</code></pre>
<p>Notice that the above expression will be true if <code>a</code> and <code>b</code> are both true, or
if <code>c</code> is true and <code>d</code> is false.</p>
<p>
<!--START question q000001 -->
<div class="question question-pythonliteral" id="cs_qdiv_q000001" style="position: static">
<div id="q000001_rendered_question">
Now, try your hand at it.  Consider the following Boolean Formula (not in CNF):
<pre><code class="language-python">a and (not b or (c and d))
</code></pre>
<p>Write an equivalent CNF formula (as a Python literal), in the format used in the lab (e.g., <code>[[('a', True), ('b', False)], [('c', True)]]</code>).<br/></p><input id="q000001" name="q000001" size="70" type="text" value=""/>
</div><div>
<span id="q000001_buttons"></span>
<span id="q000001_loading_wrapper">
<span id="q000001_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000001_score_display"></span>
<div class="nsubmits_left" id="q000001_nsubmits_left"></div></div>
<div id="q000001_solution_container">
<div id="q000001_solution">
</div>
<div id="q000001_solution_explanation">
</div>
</div>
<div id="q000001_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Monday October 19, 2020 at 11:00:00 AM Eastern time.</span></div>
<!--END question q000001 -->
</p>
<a class="anchor" name="catsoop_section_3"></a><a class="anchor" name="_sat_solver"></a><h2 class="cs_section_title">3) SAT Solver<a class="cs_permalink" href="#_sat_solver">§</a></h2>
<p>A classic tool that works on Boolean formulas is a <b>satisfiability solver</b> or SAT solver.
Given a formula, either the solver finds Boolean variable values that make the formula true, or the solver indicates that no solution exists.
In this lab, you will write a SAT solver that can solve puzzles like ours, as in:</p>
<pre><code class="language-python">&gt;&gt;&gt; print(satisfying_assignment(rules))
{'adam_c': False, 'armando': False, 'chocolate': False, 'adam_h': False,
 'saman': False, 'pickles': True, 'tim': True, 'vanilla': True}
</code></pre>
<p>The return value of <code>satisfying_assignment</code> is a dictionary mapping variables
to the Boolean values that have been inferred for them (or <code>None</code> if no valid
mapping exists).</p>
<p>So, we can see that, in our example above, Tim the Beaver is guilty and has a
taste for vanilla and pickles!</p>
<p>It turns out that there are other possible answers that have Tim enjoying other
flavors, but it also turns out that Tim is the uniquely determined culprit.
How do we know?  The SAT solver fails to find an assignment when we add an
additional rule proclaiming Tim's innocence.</p>
<pre><code class="language-python">&gt;&gt;&gt; print(satisfying_assignment(rules + [[('tim', False)]]))
None
</code></pre>
<p><a class="anchor" name="catsoop_section_3_1"></a><a class="anchor" name="_the_naive_approach"></a><h3 class="cs_section_title">3.1) The Naive Approach<a class="cs_permalink" href="#_the_naive_approach">§</a></h3></p>
<p>There's one straightforward, brute-force way to solve Boolean puzzles: enumerate all possible
Boolean assignments to the variables.  Evaluate the rules on each assignment,
returning the first assignment that works.  Unfortunately, this process can
take prohibitively long to run!  For a concrete illustration of why, consider
this Python code to generate all sequences of Booleans of a certain length.</p>
<p>When we have <span class="cs_math_to_render">N</span> Boolean variables in our puzzle, the possible assignments can
be represented as length-<span class="cs_math_to_render">N</span> sequences of Booleans.</p>
<pre><code class="language-python">def all_bools_generator(length):
    if length == 0:
        yield []
    else:
        for v in all_bools_generator(length-1):
            yield [True] + v
            yield [False] + v
def all_bools(length):
    return list(all_bools_generator(length))
</code></pre>
<p>Here's an example output.</p>
<pre><code class="language-python">&gt;&gt;&gt; all_bools(3)
[[True, True, True], [False, True, True], [True, False, True],
 [False, False, True], [True, True, False], [False, True, False],
 [True, False, False], [False, False, False]]
</code></pre>
<p>We could get more ambitious and try to generate longer sequences.</p>
<pre><code class="language-python">&gt;&gt;&gt; len(all_bools(3))
8
&gt;&gt;&gt; len(all_bools(4))
16
&gt;&gt;&gt; len(all_bools(5))
32
&gt;&gt;&gt; len(all_bools(6))
64
&gt;&gt;&gt; len(all_bools(20))
1048576
&gt;&gt;&gt; len(all_bools(25))
# Python runs for long enough that we give up!
</code></pre>
<p>It's actually quite expensive even to run through all Boolean sequences of
nontrivial lengths, let alone to test each sequence against the rules.  The
reason is that there are <span class="cs_math_to_render">2^N</span> length-<span class="cs_math_to_render">N</span> Boolean sequences, and that kind of
exponential function grows quite quickly as the length <span class="cs_math_to_render">N</span> of our mappings
grows.</p>
<p>Lots of logic puzzles can lead to hundreds of Boolean variables.  Are we out of
luck if we want Python to do all the work?  Worry not!  In this lab, you will
implement a SAT solver that uses a much smarter algorithm than this brute-force
enumeration of all assignments, thanks to the magic of backtracking search.</p>
<p><a class="anchor" name="catsoop_section_3_2"></a><a class="anchor" name="_a_nicer_approach"></a><h3 class="cs_section_title">3.2) A Nicer Approach<a class="cs_permalink" href="#_a_nicer_approach">§</a></h3></p>
<p>Instead of enumerating all assignments, we will ask you to implement a more
clever approach for Boolean satisfiability.  One such approach is outlined
below (with some of the details intentionally omitted):</p>
<p>We start by picking an arbitrary variable <span class="cs_math_to_render">x</span> from our formula <span class="cs_math_to_render">F</span>.  We then
construct a related formula <span class="cs_math_to_render">F_1</span>, which does not involve <span class="cs_math_to_render">x</span> but incorporates
all the consequences of setting <span class="cs_math_to_render">x</span> to be <code>True</code>.  We then try to solve <span class="cs_math_to_render">F_1</span>.
If it produces a successful result, we can combine that result with information
about <span class="cs_math_to_render">x</span> being <code>True</code> to produce our answer to the original problem.</p>
<p>If we could not solve <span class="cs_math_to_render">F_1</span>, we should try setting <span class="cs_math_to_render">x</span> to be <code>False</code> instead.
If no solution exists in either of the above cases, then the formula <span class="cs_math_to_render">F</span> cannot
be satisfied.</p>
<p><a class="anchor" name="catsoop_section_3_2_1"></a><a class="anchor" name="_updating_expressions"></a><h4 class="cs_section_title">3.2.1) Updating Expressions<a class="cs_permalink" href="#_updating_expressions">§</a></h4></p>
<p>A key operation here is updating a formula to model the effect of a variable
assignment.  As an example, consider this starting formula.</p>
<pre><code class="language-python">(a or b or not c) and (c or d)
</code></pre>
<p>If we learn <code>c = True</code>, then the formula should be updated as follows.</p>
<pre><code class="language-python">(a or b)
</code></pre>
<p>We removed <code>not c</code> from the first clause, because we now know conclusively that
that literal is <code>False</code>.  Conversely, we can remove the second clause, because
with <code>c</code> true, it is assured that the clause will be satisfied.</p>
<p>Note a key effect of this operation: <em>variable <code>d</code> has disappeared from the
formula, so we no longer need to consider values for <code>d</code></em>.</p>
<p>In general, this approach often saves us from an exponential enumeration of
variable values, because we learn that, in some branches of the search space,
some variables are actually irrelevant to the problem.</p>
<p>This pruning will show up in the assignments that your SAT solver returns: you
are allowed (but not required) to omit variables that turn out to be
irrelevant.</p>
<p>If we had instead learned that <code>c</code> was <code>False</code>, we would update the formula
instead as follows:</p>
<pre><code class="language-python">d
</code></pre>
<p>How did we get there?  Note that, with <code>c</code> being <code>False</code>, the first clause is
already satisfied.  The second clause, though, will only be <code>True</code> if <code>d</code> is
<code>True</code>.</p>
<p><strong>It might be a good idea to implement this process (updating a formula based
on a new assignment) as a helper function (which you can test independently),
as we will need to perform this operation repeatedly.</strong></p>
<p><a class="anchor" name="catsoop_section_3_2_2"></a><a class="anchor" name="_examples_2"></a><h4 class="cs_section_title">3.2.2) Examples<a class="cs_permalink" href="#_examples_2">§</a></h4></p>
<p>Consider this CNF formula, in the form we use in this lab:</p>
<pre><code class="language-python">[
    [('a', True), ('b', True), ('c', True)],
    [('a', False), ('f', True)],
    [('d', False), ('e', True), ('a', True), ('g', True)],
    [('h', False), ('c', True), ('a', False), ('f', True)],
]
</code></pre>
<p>
<!--START question q000002 -->
<div class="question question-pythonic" id="cs_qdiv_q000002" style="position: static">
<div id="q000002_rendered_question">
Write a CNF formula for the case where <code>a = True</code>, without using variable <code>a</code>.  Write the string <code>'falsifies'</code> if this assignment falsifies the formula, and write the string <code>'truthifies'</code> if this assignment renders the formula true.<br/><input id="q000002" name="q000002" size="70" type="text" value=""/>
</div><div>
<span id="q000002_buttons"></span>
<span id="q000002_loading_wrapper">
<span id="q000002_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000002_score_display"></span>
<div class="nsubmits_left" id="q000002_nsubmits_left"></div></div>
<div id="q000002_solution_container">
<div id="q000002_solution">
</div>
<div id="q000002_solution_explanation">
</div>
</div>
<div id="q000002_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Monday October 19, 2020 at 11:00:00 AM Eastern time.</span></div>
<!--END question q000002 -->
</p>
<p>
<!--START question q000003 -->
<div class="question question-pythonic" id="cs_qdiv_q000003" style="position: static">
<div id="q000003_rendered_question">
Write a CNF formula for the case where <code>a = False</code>, without using variable <code>a</code>.  Write the string <code>'falsifies'</code> if this assignment falsifies the formula, and write the string <code>'truthifies'</code> if this assignment renders the formula true.<br/><input id="q000003" name="q000003" size="70" type="text" value=""/>
</div><div>
<span id="q000003_buttons"></span>
<span id="q000003_loading_wrapper">
<span id="q000003_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000003_score_display"></span>
<div class="nsubmits_left" id="q000003_nsubmits_left"></div></div>
<div id="q000003_solution_container">
<div id="q000003_solution">
</div>
<div id="q000003_solution_explanation">
</div>
</div>
<div id="q000003_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Monday October 19, 2020 at 11:00:00 AM Eastern time.</span></div>
<!--END question q000003 -->
</p>
<p>
<!--START question q000004 -->
<div class="question question-pythonic" id="cs_qdiv_q000004" style="position: static">
<div id="q000004_rendered_question">
Write a CNF formula for the case where <code>a = True</code> and <code>f = True</code>, without using variables <code>a</code> or <code>f</code>.  Write the string <code>'falsifies'</code> if this assignment falsifies the formula, and write the string <code>'truthifies'</code> if this assignment renders the formula true.<br/><input id="q000004" name="q000004" size="70" type="text" value=""/>
</div><div>
<span id="q000004_buttons"></span>
<span id="q000004_loading_wrapper">
<span id="q000004_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000004_score_display"></span>
<div class="nsubmits_left" id="q000004_nsubmits_left"></div></div>
<div id="q000004_solution_container">
<div id="q000004_solution">
</div>
<div id="q000004_solution_explanation">
</div>
</div>
<div id="q000004_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Monday October 19, 2020 at 11:00:00 AM Eastern time.</span></div>
<!--END question q000004 -->
</p>
<p>
<!--START question q000005 -->
<div class="question question-pythonic" id="cs_qdiv_q000005" style="position: static">
<div id="q000005_rendered_question">
Write a CNF formula for the case where <code>a = True</code> and <code>f = False</code>, without using variables <code>a</code> or <code>f</code>.  Write the string <code>'falsifies'</code> if this assignment falsifies the formula, and write the string <code>'truthifies'</code> if this assignment renders the formula true.<br/><input id="q000005" name="q000005" size="70" type="text" value=""/>
</div><div>
<span id="q000005_buttons"></span>
<span id="q000005_loading_wrapper">
<span id="q000005_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000005_score_display"></span>
<div class="nsubmits_left" id="q000005_nsubmits_left"></div></div>
<div id="q000005_solution_container">
<div id="q000005_solution">
</div>
<div id="q000005_solution_explanation">
</div>
</div>
<div id="q000005_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Monday October 19, 2020 at 11:00:00 AM Eastern time.</span></div>
<!--END question q000005 -->
</p>
<a class="anchor" name="catsoop_section_4"></a><a class="anchor" name="_implementation"></a><h2 class="cs_section_title">4) Implementation<a class="cs_permalink" href="#_implementation">§</a></h2>
<p>Implement the function <code>satisfying_assignment</code> as described in <code>lab.py</code>.  Your
function should take as input a CNF formula (in the form described throughout
this writeup).  It should return a dictionary mapping variable names to Boolean
values if there exists such an assignment that satisfies the given formula.  If
no such assignment exists, it should return <code>None</code>.</p>
<p><a class="anchor" name="catsoop_section_4_1"></a><a class="anchor" name="_optimizations"></a><h3 class="cs_section_title">4.1) Optimizations<a class="cs_permalink" href="#_optimizations">§</a></h3></p>
<p>A couple of further optimizations are likely to be necessary in order to pass
all of the test cases quickly enough on the server:</p>
<ul>
<li>
<p>In the procedure described above, if setting the value of <span class="cs_math_to_render">x</span> immediately leads
to a contradiction, we can immediately discard that possibility (rather than
waiting for a later step in the recursive process to notice the contradiction).</p>
</li>
<li>
<p>At the start of any call to your procedure, check if the formula contains any
length-one clauses ("unit" clauses).
If such a clause <code>[(x, b)]</code> exists, then we may set <code>x</code> to Boolean value <code>b</code>,
just as we do in the <code>True</code> and <code>False</code> cases of the outline above.
However, we know that, if this setting leads to failure, there is no need
to backtrack and also try <code>x = not b</code> (because the unit clause alone tells
us exactly what the value of <code>x</code> must be)!</p>
<p>Thus, you can begin your function with a loop that repeatedly finds unit
clauses, if any, and propagates their consequences through the formula.
Propagating the effects of one unit clause may reveal further unit clauses,
whose later propagations may themselves reveal more unit clauses, and so on.</p>
</li>
</ul>
<p>Implementing function <code>satisfying_assignment</code> in this way should allow your
code to pass the <code>test_sat</code> and <code>test_sat_sudoku</code> test cases in time. The
<code>test_sat_sudoku</code> tests will use your SAT solver to solve sudoku puzzles,
which can also be expressed in CNF<a class="anchor" name="catsoop_footnote_ref_1"></a><a href="#catsoop_footnote_1"><sup>1</sup></a>! These test cases are large, so consider
making smaller test cases to debug them.</p>
<p>You are free to add additional optimizations beyond what we laid out above, or
even make broader changes to the algorithm, so long as you avoid "hard coding"
for rather specific SAT problems (except for base cases like empty formulas).</p>
<a class="anchor" name="catsoop_section_5"></a><a class="anchor" name="_scheduling_by_reduction"></a><h2 class="cs_section_title">5) Scheduling by Reduction<a class="cs_permalink" href="#_scheduling_by_reduction">§</a></h2>
<p>Now that we have a fancy new SAT solver, let's look at applying it to a new
problem!</p>
<p>In general, it's possible to write a new implementation of backtracking search
for each new problem we encounter, but another strategy is to <em>reduce</em> a new
problem to one that we already know how to solve well.  Boolean satisfiability
is a popular target for reductions, because a lot of effort has gone into
building fast SAT solvers.  In this last part of the lab, you will implement a
reduction to SAT from a scheduling problem.</p>
<p>In particular, we are interested in the real-life problem of assigning 6.009
students to different sessions for taking a quiz.
Each student is available for only some of the sessions, but each session has
limited capacity.  We want to find a schedule (assignment of students to
sessions) that respects all the constraints.</p>
<p>Please implement the function
<code>boolify_scheduling_problem(student_preferences, session_capacities)</code>
as described both below and in <code>lab.py</code>:</p>
<ul>
<li>
<p>The argument <code>student_preferences</code> is a dictionary mapping a student name
(string) to a set of session names (strings) when that student is available.</p>
</li>
<li>
<p>Argument <code>session_capacities</code> is a dictionary mapping each session name to a
positive integer for how many students can fit in that session.</p>
</li>
<li>
<p>The function returns a CNF formula encoding the schedule problem, as we
explain next.</p>
</li>
</ul>
<p>Here's an example call:</p>
<pre><code class="language-python">boolify_scheduling_problem({'Alice': {'basement', 'penthouse'},
                            'Bob': {'kitchen'},
                            'Charles': {'basement', 'kitchen'},
                            'Dana': {'kitchen', 'penthouse', 'basement'}},
                           {'basement': 1,
                            'kitchen': 2,
                            'penthouse': 4})
</code></pre>
<p>In English, Alice is available for the sessions in the basement and penthouse,
Bob is available only for the session in the kitchen, etc.
The basement can fit 1 student, the kitchen 2 students, and the penthouse 4
students.
In this case, one legal schedule would be Alice in the basement, Bob in the
kitchen, Charles in the kitchen, and Dana in the penthouse.</p>
<p>Your job is to translate such inputs into CNF formulas, such that your SAT
solver can then find a legal schedule (or confirm that none exists).</p>
<p>The CNF formula you output should mention only Boolean variables named like
<code>student_session</code>, where <code>student</code> is the name of a student, and where
<code>session</code> is the name of a session.
The variable <code>student_session</code> should be <code>True</code> if and only if that student is
assigned to that session (for example, the variable <code>Bob_kitchen</code> should be
<code>True</code> if Bob is in the kitchen and <code>False</code> otherwise).</p>
<p>The CNF clauses you include should enforce exactly the following rules (which
are discussed in more detail below):</p>
<ol>
<li>Students are only assigned to sessions included in their preferences.</li>
<li>Each student is assigned to exactly one session.</li>
<li>No session has more assigned students than it can fit.</li>
</ol>
<p>Our requirement for this part of the lab is that your code <em>should not</em> solve
the optimization problem.  Rather, you should implement a translation to CNF
formulas (which <code>satisfying_assignment</code> can then solve).</p>
<p>During the checkoff, our staff will try to make sure you've followed this rule
and not merely, say, implemented a backtracking search directly for the
scheduling problem, to output trivial CNF problems that encode
answers directly.</p>
<p><a class="anchor" name="catsoop_section_5_1"></a><a class="anchor" name="_encoding_the_rules"></a><h3 class="cs_section_title">5.1) Encoding the Rules<a class="cs_permalink" href="#_encoding_the_rules">§</a></h3></p>
<p>Turning these rules into CNF formulas is a tricky task.  We'll try to provide
some guidance for thinking about each of these rules in the following sections
(though if you get stuck, please don't hesitate to ask via
the <a href="https://py.mit.edu/forum/c/labs/lab-6" target="_blank">Forum</a>).</p>
<p>Note that each of these rules can be expressed as its own CNF formula, and the
AND of these three rules represents the overall formula we need to solve.  As
such, you may wish to write a helper function to generate the formula for each
of these rules and to use those helper functions in <code>boolify_scheduling_problem</code>.</p>
<p><strong>The examples below also make nice test cases to add to your lab.py or test.py
(simpler than many we will test your code on)!</strong>  Note also that computing the
results for the examples below may also be difficult to do without some
additional scratch paper (or at least a bigger text editing area than the
little boxes below).</p>
<p><a class="anchor" name="catsoop_section_5_1_1"></a><a class="anchor" name="_students_only_in_desired_sessions"></a><h4 class="cs_section_title">5.1.1) Students Only In Desired Sessions<a class="cs_permalink" href="#_students_only_in_desired_sessions">§</a></h4></p>
<p>For each student, we need to guarantee that they are given a session that they
selected as one of their preferences.  In the example above, for example, we
know that Charles must be in the basement or the kitchen, and that Alice must
be in the basement or in the penthouse.</p>
<p>
<!--START question q000006 -->
<div class="question question-pythonic" id="cs_qdiv_q000006" style="position: static">
<div id="q000006_rendered_question">
In the box below, enter a CNF formula expressing this constraint
(students are only assigned to sessions in their preferences) for the example data
above (with Alice, Bob, Charles, and Dana).  Use variable names of the form
described above (e.g., <code>'Bob_kitchen'</code> represents Bob being in the
kitchen).<br/><input id="q000006" name="q000006" size="50" type="text" value=""/>
</div><div>
<span id="q000006_buttons"></span>
<span id="q000006_loading_wrapper">
<span id="q000006_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000006_score_display"></span>
<div class="nsubmits_left" id="q000006_nsubmits_left"></div></div>
<div id="q000006_solution_container">
<div id="q000006_solution">
</div>
<div id="q000006_solution_explanation">
</div>
</div>
<div id="q000006_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Friday October 23, 2020 at 04:00:00 PM Eastern time.</span></div>
<!--END question q000006 -->
</p>
<div class="question"><b>Check Yourself:</b><p>How could you generate this formula from the arguments given to
<code>boolify_scheduling_problem</code>?</p><p><span id="queue_checkyourself_1"></span></p></div>
<p><a class="anchor" name="catsoop_section_5_1_2"></a><a class="anchor" name="_each_student_in_exactly_one_session"></a><h4 class="cs_section_title">5.1.2) Each Student In Exactly One Session<a class="cs_permalink" href="#_each_student_in_exactly_one_session">§</a></h4></p>
<p>This rule is a little bit trickier, but it may help to separate it into two pieces:</p>
<ul>
<li>each student must be in at least one session, <strong>and</strong></li>
<li>each student must be in at most one session.</li>
</ul>
<p>We can generate formulae for each of these conditions and combine them to
construct the overall formula corresponding to this rule.</p>
<p>In fact, the first bullet (that each student be assigned to at least one
session) is redundant with our first condition (that each student be assigned
to a session in their preferences).</p>
<p>So let's turn our attention to making sure that each student is assigned to <em>at
most one session</em>.  This one is a bit trickier, particularly since we need to
put things in CNF.  One flip of perspective that can be helpful is that, if we
need each student to be in at most one session, that means that for any pair of
sessions, any given student can be in only <em>one</em> of them.</p>
<p>For example, one clause in this expression will say that Bob cannot be in both
the kitchen and the basement.  That is, we cannot have both <code>Bob_kitchen</code> and
<code>Bob_basement</code> be <code>True</code> (or, to phrase it a different way, at least one of
them must be <code>False</code>).</p>
<p>Note that there is a corresponding clause for every other pair of sessions; and
each of these clauses has a corresponding clause for Alice (and the other
students).  For purposes of this question, include <em>all</em> sessions for each
student, regardless of their preferences.</p>
<p>
<!--START question q000007 -->
<div class="question question-pythonic" id="cs_qdiv_q000007" style="position: static">
<div id="q000007_rendered_question">
In the box below, enter a CNF formula expressing this
constraint (students are in at most one session) for the example data above
(with Alice, Bob, Charles, and Dana).  Use variable names of the form described
above (e.g., <code>'Bob_kitchen'</code> represents Bob being in the kitchen).<br/><input id="q000007" name="q000007" size="70" type="text" value=""/>
</div><div>
<span id="q000007_buttons"></span>
<span id="q000007_loading_wrapper">
<span id="q000007_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000007_score_display"></span>
<div class="nsubmits_left" id="q000007_nsubmits_left"></div></div>
<div id="q000007_solution_container">
<div id="q000007_solution">
</div>
<div id="q000007_solution_explanation">
</div>
</div>
<div id="q000007_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Friday October 23, 2020 at 04:00:00 PM Eastern time.</span></div>
<!--END question q000007 -->
</p>
<div class="question"><b>Check Yourself:</b><p>How could you generate this formula from the arguments given to
<code>boolify_scheduling_problem</code>?</p><p><span id="queue_checkyourself_2"></span></p></div>
<p><a class="anchor" name="catsoop_section_5_1_3"></a><a class="anchor" name="_no_oversubscribed_sessions"></a><h4 class="cs_section_title">5.1.3) No Oversubscribed Sessions<a class="cs_permalink" href="#_no_oversubscribed_sessions">§</a></h4></p>
<p>This last rule is also fairly tricky, and it maybe requires a bit of a shift of
perspective to express this constraint in CNF.  However, it is similar to the
previous rule in some ways.</p>
<p>We can think about this as: if a given session can contain <span class="cs_math_to_render">N</span> students, then in
every possible group of <span class="cs_math_to_render">N+1</span> students, there must be at least one student who
is <em>not</em> in the given session.</p>
<p>For example, since the kitchen holds 2 people, we would need to consider all
possible groups of 3 students and make sure that at least one of them is <em>not</em>
in that session.  For purposes of this question, include <em>all</em> groups of students,
regardless of their preferences.</p>
<p>What about the penthouse?  It has enough room for everyone, so there is no need
even to include it in the constraints (it doesn't constrain our decision in any
way)!</p>
<p>
<!--START question q000008 -->
<div class="question question-pythonic" id="cs_qdiv_q000008" style="position: static">
<div id="q000008_rendered_question">
In the box below, enter a CNF formula expressing this constraint
(no oversubscribed sessions) for the example data above (with Alice, Bob,
Charles, and Dana).  Use variable names of the form described above (e.g.,
<code>'Bob_kitchen'</code> represents Bob being in the kitchen).<br/><input id="q000008" name="q000008" size="70" type="text" value=""/>
</div><div>
<span id="q000008_buttons"></span>
<span id="q000008_loading_wrapper">
<span id="q000008_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="q000008_score_display"></span>
<div class="nsubmits_left" id="q000008_nsubmits_left"></div></div>
<div id="q000008_solution_container">
<div id="q000008_solution">
</div>
<div id="q000008_solution_explanation">
</div>
</div>
<div id="q000008_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Friday October 23, 2020 at 04:00:00 PM Eastern time.</span></div>
<!--END question q000008 -->
</p>
<div class="question"><b>Check Yourself:</b><p>How could you generate this formula from the arguments given to
<code>boolify_scheduling_problem</code>?</p><p><span id="queue_checkyourself_3"></span></p></div>
<a class="anchor" name="catsoop_section_6"></a><a class="anchor" name="_ui"></a><h2 class="cs_section_title">6) UI<a class="cs_permalink" href="#_ui">§</a></h2>
<p>We have provided a browser UI for this lab, so you can see your code solving
scheduling problems in action! When you have implemented both main functions
of the lab, you may run <code>python3 server.py</code> and navigate to <a href="http://localhost:6009/"><code>http://localhost:6009/</code></a>. Running a test case on the UI
involves generating a CNF formula and searching for a satisfying assignment for
it, done by calling your functions. Enjoy!</p>
<a class="anchor" name="catsoop_section_7"></a><a class="anchor" name="_code_submission"></a><h2 class="cs_section_title">7) Code Submission<a class="cs_permalink" href="#_code_submission">§</a></h2>
<p>Once you have debugged your code locally and are satisfied, upload your
<code>lab.py</code> below:</p>
<p>
<!--START question code -->
<div class="question question-lab009" id="cs_qdiv_code" style="position: static">
<div id="code_rendered_question">
<input id="code" name="code" style="display: none" type="file"/><button class="btn btn-catsoop" id="code_select_button">Select File</button> <tt><span id="code_selected_file">No file selected</span></tt>
<script type="text/javascript">
document.getElementById('code').value = '';
document.getElementById('code_select_button').addEventListener('click', function (){
    document.getElementById("code").click();
});
document.getElementById('code').addEventListener('change', function (){
    document.getElementById('code_selected_file').innerText = document.getElementById('code').value;
});
</script>
</div><div>
<span id="code_buttons"></span>
<span id="code_loading_wrapper">
<span id="code_loading" style="display:none;"><img src="data:image/gif;base64,R0lGODlhEAAQAPIGAMLCwkJCQgAAAGJiYoKCgpKSkv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAGACwAAAAAEAAQAAADMmi63P4wyklrAyEAGoQInAdOmGYBw7AxwLoMGcG2rkHEQFHQLTsQOd2mB9ERCpTWzpEAACH5BAkKAAYALAAAAgAKAA4AAAMraAYRoNAEIUJUs97VHgTD4EVDQ2xEM2wgMV5AUbyKLKNEvoxA3P8sYNCQAAAh+QQJCgAGACwAAAAACgAOAAADLWi6EAFrBSGCAmQ0as1wROFABuEM0TUQ5FUU7fK+aRkWNYDFqV4bOl8v+BMuEgAh+QQJCgAGACwAAAAADgAKAAADKmi6QAMrrhECkaaVVl+FRiFuAwEEghAoYxGhqgI0oPxlNSbPOcb3PqAkAQAh+QQJCgAGACwCAAAADgAKAAADKWhqUAUrLuekApA+MiDD4BYExAVGwzgsmNR0lgWMXmwEghDYCq7zDFoCACH5BAkKAAYALAYAAAAKAA4AAAMqaADWros9GEuRUBE7jeUTYGEhMZANEQREN6xDJ54PsKJGIAhBp/OyWyMBACH5BAkKAAYALAYAAgAKAA4AAAMpaKoA+609Fie1C5Tipt7WRhRWw0ED0T1DEAyMq7mEEghCAKTdnZcySwIAIfkEBQoABgAsAgAGAA4ACgAAAytoumwALb4X2YR1URACVkBRYIEgBIw4KuUJDERIzGD3doMhfguBZyAYT5EAADs="/></span>
</span>
<span id="code_score_display"></span>
<div class="nsubmits_left" id="code_nsubmits_left"></div></div>
<div id="code_solution_container">
<div id="code_solution">
</div>
<div id="code_solution_explanation">
</div>
</div>
<div id="code_message"></div>
<span style="font-size: small; color: #888; font-weight: bold;">This question is due on Friday October 23, 2020 at 04:00:00 PM Eastern time.</span></div>
<!--END question code -->
</p>
<style>
.impsolution{display:none;}
</style>
<a class="anchor" name="catsoop_section_8"></a><a class="anchor" name="_checkoff"></a><h2 class="cs_section_title">8) Checkoff<a class="cs_permalink" href="#_checkoff">§</a></h2>
<p>Once you are finished with the code, please come to office hours
and add yourself to the queue asking for a checkoff.  <strong>You must be
ready to discuss your code and test cases in detail before asking for a checkoff.</strong></p>
<p>You should be prepared to demonstrate your code (which should be
well-commented, should avoid repetition, and should make good use of helper
functions).  In particular, be prepared to discuss:</p>
<ul>
<li>In English, the general recipe for finding assignments that satisfy a given CNF formula.</li>
<li>In English, your strategy for updating a formula based on setting an variable to be <code>True</code> or <code>False</code>.</li>
<li>Your implementation of <code>satisfying_assignment</code>, including any helper functions.</li>
<li>In English, the general recipe you came up with for translating scheduling problems into CNF formulas (including all three rules).</li>
<li>Your code for <code>boolify_scheduling_problem</code> to implement that recipe.</li>
</ul>
<p><a class="anchor" name="catsoop_section_8_1"></a><a class="anchor" name="_grade"></a><h3 class="cs_section_title">8.1) Grade<a class="cs_permalink" href="#_grade">§</a></h3></p>
<div class="response"><i>You have not yet received this checkoff.  When you have completed this checkoff, you will see a grade here.</i></div>
<script src="https://py.mit.edu/_static/_handler/default/cs_ajax.js" type="text/javascript"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
catsoop.all_questions = ['q000000', 'q000001', 'q000002', 'q000003', 'q000004', 'q000005', 'q000006', 'q000007', 'q000008', 'code'];
catsoop.username = null;
catsoop.api_token = null;
catsoop.this_path = 'https://py.mit.edu/fall20/labs/lab6';
catsoop.path_info = ['fall20', 'labs', 'lab6'];
catsoop.course = 'fall20';
catsoop.url_root = 'https://py.mit.edu';
catsoop.imp = '';
catsoop.skip_alert = [];
catsoop.viewans_confirm = "Are you sure?  Viewing the answer will prevent any further submissions to this question.  Press 'OK' to view the answer, or press 'Cancel' if you have changed your mind.";

// @license-end</script>
<br/> <hr/><b name="cs_footnotes">Footnotes</b><p><a class="anchor" name="catsoop_footnote_1"></a><sup style="padding-right:0.25em;color:var(--cs-base-bg-color);">1</sup>For a brief description of how these test cases were generated, see <a href="http://www.cs.qub.ac.uk/~I.Spence/SuDoku/SuDoku.html" target="_blank">this link</a>, which describes the process. <a href="#catsoop_footnote_ref_1"><span class="noprint">(click to return to text)</span></a></p>
</div>
</div>
<div class="cs_right_menu"></div>
</main>
<footer>
<div class="cs_navigation cs_bottom_navigation" id="cs_bottom_navigation"><span class="line"><a href="https://py.mit.edu/fall20">Home</a></span> <span class="cs_nav_separator">/</span> <span class="line"><a href="https://py.mit.edu/fall20/labs/lab6">Lab 6: SAT Solver</a></span></div>
<div class="cs_footer">
      This page was last updated on Friday October 16, 2020 at 01:18:00 PM (revision <code>0392b484</code>).<br/> <br/>
<pre class="catsooplogo" style="font-size:50%;">\            
/    /\__/\  
\__=(  o_O )=
(__________) 
 |_ |_ |_ |_ </pre>
      Powered by <a href="https://catsoop.mit.edu" target="_blank">CAT-SOOP</a> v2021.2.0.dev1971+hg ("Devon Rex" development snapshot).<br/>
      CAT-SOOP is <a href="https://www.fsf.org/about/what-is-free-software" target="_blank">Free/Libre Software</a>, available under the terms<br/>of the <a href="https://py.mit.edu/_util/license" target="_blank">GNU Affero General Public License, version 3</a>.<br/>
<a download="" href="https://py.mit.edu/_util/source.zip" target="_blank">Download Source Code</a><br/>
<a href="https://py.mit.edu/_util/jslicense.html" rel="jslicense" target="_blank">Javascript License Information</a>
</div>
</footer>
</body>
</html>

